(()=>{"use strict";var t={591:function(t,e,i){var s=i(412);class o{on(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.eventMap[t].push({fn:e,once:i})}off(t,e){let i=this.eventMap[t];if(e){for(let t=0;t<i.length;++t)if(e===i[t].fn){i.splice(t,1);break}}else this.eventMap[t]=[]}offAll(){for(let t of Object.keys(this.eventMap))this.eventMap[t]=[]}emit(t){let e=this.eventMap[t];for(let i=e.length-1;i>=0;--i){let s=e[i];s.fn(),s.once&&this.off(t,s.fn)}}hnPlay(){this.emit("play")}hnPause(){this.emit("pause")}hnEnded(){this.stop(),this.emit("ended")}load(){this.audio.load()}play(){this.stop(),this.audio.play().catch(t=>{})}resume(){this.audio.play()}pause(){this.audio.pause()}stop(){this.audio.readyState>0&&(this.audio.pause(),this.audio.currentTime=0)}seek(t){this.audio.currentTime=t/1e3}get paused(){let t=!1;return this.audio.paused&&0!==this.audio.currentTime&&(t=!0),t}get currentTime(){return this.audio.currentTime}get duration(){return this.audio.duration}set volume(t){t<0||t>1||(this.audio.volume=t)}constructor(t){(0,s._)(this,"audio",void 0),(0,s._)(this,"eventMap",void 0),(0,s._)(this,"audioOption",void 0),(0,s._)(this,"bindPlay",void 0),(0,s._)(this,"bindPause",void 0),(0,s._)(this,"bindEnded",void 0),this.audioOption=t,this.audio=new Audio,this.audio.preload="none",this.audio.src=t.src,t.loop&&(this.audio.loop=t.loop),t.volume&&(this.audio.volume=t.volume),t.autoplay&&this.play(),this.eventMap={play:[],pause:[],ended:[]},this.bindPlay=this.hnPlay.bind(this),this.bindPause=this.hnPause.bind(this),this.bindEnded=this.hnEnded.bind(this),this.audio.addEventListener("play",this.bindPlay),this.audio.addEventListener("pause",this.bindPause),this.audio.addEventListener("ended",this.bindEnded)}}let n=new class{add(t){if(Array.isArray(t))for(let e of t)this._add(e);else this._add(t)}_add(t){if(this.isContain(t.id))return;let e=Object.assign({volume:1,loop:!1,ignoreStop:!1,tag:"default"},t),i=new o(e);this.sounds.set(t.id,{sound:i,...e})}get(t){var e;return(null==(e=this.sounds.get(t))?void 0:e.sound)??null}on(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.get(t);o&&o.on(e,i,s)}off(t,e,i){let s=this.get(t);s&&s.off(e,i)}play(t,e){let i=this.get(t);i&&(e&&(this.off(t,"ended"),this.on(t,"ended",e,!0)),i.play())}resume(t){let e=this.get(t);e&&e.resume()}pause(t){let e=this.get(t);e&&e.pause()}stop(t){let e=this.get(t);e&&e.stop()}seek(t,e){let i=this.get(t);i&&i.seek(e)}stopAll(){for(let t of this.sounds.values())t.ignoreStop||"bgm"===t.tag||t.sound.stop()}resumeAll(){for(let t of this.pauseSounds)t.resume();this.pauseSounds=[]}pauseAll(){for(let t of this.sounds.values())t.sound.paused||(t.sound.pause(),this.pauseSounds.push(t.sound))}getPaused(t){let e=this.get(t);return!!e&&e.paused}getDuration(t){let e=-1,i=this.get(t);return i?e=i.duration:e}getCurrentTime(t){let e=-1,i=this.get(t);return i?e=i.currentTime:e}setVolume(t,e){if(e){let i=this.get(e);i&&(i.volume=t)}else for(let e of this.sounds.values())e.sound.volume=t}loadAll(){for(let t of this.sounds.values())t.sound.load()}isContain(t){let e=!1;for(let i of this.sounds.keys())if(t===i){e=!0;break}return e}constructor(){(0,s._)(this,"sounds",new Map),(0,s._)(this,"pauseSounds",[]),this.sounds=new Map,this.pauseSounds=[]}};var r=i(534);function a(t,e){let i=new CustomEvent("MESSAGE",{detail:e});t.dispatchEvent(i)}function l(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i]}function h(){let t=new r.UAParser().getDevice();return("mobile"===t.type||"tablet"===t.type)&&("iPhone"===t.model||"iPad"===t.model)}i(736);let c=i.p+"audio/global/button.mp3";window.bound={x:0,y:0,scale:1},window.globalVolume=1,window.getZoomRate=()=>window.bound.scale;var d=i(370);class p{start(){this.resume()}end(){a(window,{message:"FRAME_CALL_END",mc:this.mc}),this.dispose()}dispose(){this.mc&&(this.pause(),this.queue=null)}resume(){this.mc&&(this.mc.addEventListener("tick",this.bindTick),this.mc.visible=!0,this.mc.gotoAndPlay(this.s))}pause(){this.mc&&(this.mc.removeEventListener("tick",this.bindTick),this.mc.stop())}hnTick(){let t,e;if(this.queue){for(let[i,s]of this.queue)if("string"==typeof i&&("end"===i&&this.mc.currentFrame===this.mc.totalFrames-1||this.mc.currentLabel===i)||this.mc.currentFrame===i){t=i,e=s;break}"string"==typeof this.e?this.mc.currentLabel===this.e&&this.end():this.mc.currentFrame===this.e&&this.end(),t&&e&&this.executeQueue(t,e)}}executeQueue(t,e){e(),this.queue&&this.queue.delete(t)}constructor(t,e,i,o){(0,s._)(this,"mc",void 0),(0,s._)(this,"s",void 0),(0,s._)(this,"e",void 0),(0,s._)(this,"queue",void 0),(0,s._)(this,"bindTick",void 0),this.mc=t,this.s=e,this.e=i,this.queue=o,this.queue||(this.queue=new Map),this.bindTick=this.hnTick.bind(this)}}window.createjs=d.Z;class u{getContainer(){if(!this.container)throw Error("Container not initialized");return this.container}init(){let t=Object.keys(window.AdobeAn.compositions)[0],e=window.AdobeAn.compositions[t],i=new d.Z.LoadQueue(!1);i.installPlugin(d.Z.Sound),i.addEventListener("fileload",t=>{this.handleFileLoad(t,e)}),i.addEventListener("complete",t=>{this.handleComplete(t,e)});let s=e.getLibrary();d.Z.MotionGuidePlugin.install();let o=s.properties.manifest;if(h())o.map(t=>{this.args.manifestSrc&&(t.src=this.args.manifestSrc.concat("/",t.src))}),o.length>0?i.loadManifest(o):this.setupComplete(s);else{let t=[];o.map(e=>{this.args.manifestSrc&&(e.src=this.args.manifestSrc.concat("/",e.src)),-1===e.src.indexOf(".mp3")?t.push(e):n.add({id:e.id,src:e.src,tag:this.args.stageContent})}),t.length>0?i.loadManifest(t):this.setupComplete(s)}}handleFileLoad(t,e){let i=e.getImages();(null==t?void 0:t.item.type)==="image"&&(i[t.item.id]=t.result)}handleComplete(t,e){let i=e.getLibrary(),s=e.getSpriteSheet(),o=t.target,n=i.ssMetadata;for(let t=0;t<n.length;t++)s[n[t].name]=new d.Z.SpriteSheet({images:[o.getResult(n[t].name)],frames:n[t].frames});this.setupComplete(i)}setupComplete(t){if(this.lib=t,this.exportRoot=new t[this.args.stageContent],this.exportRoot.name=`exportRoot_${this.args.stageContent}`,this.stage=new t.Stage(this.canvas),d.Z.Touch.enable(this.stage,!0,!1),this.stage.enableMouseOver(),this.addGlobal(),this.canvas&&u.SCALE_UP&&!function(){let t=new r.UAParser().getDevice();return"mobile"===t.type||"tablet"===t.type}()){let t=this.args.canvasSize.w,e=this.args.canvasSize.h;this.canvas.style.width=`${t}px`,this.canvas.style.height=`${e}px`,this.canvas.width=2*t,this.canvas.height=2*e,this.stage.scaleX=2,this.stage.scaleY=2}d.Z.Ticker.framerate=t.properties.fps,d.Z.Ticker.timingMode=d.Z.Ticker.TIMEOUT,d.Z.Ticker.interval=30,d.Z.Ticker.addEventListener("tick",this.stage),this.stage.addChild(this.exportRoot),this.stage.tickEnabled=!1,a(window,{message:u.READY_COMPLETE,self:this}),this.args.autoplay&&this.start()}start(){this.stage.tickEnabled=!0,a(window,{message:u.START,self:this})}pause(){this.stage&&(this.stage.tickEnabled=!1)}resume(){this.stage&&(this.stage.tickEnabled=!0)}addGlobal(){window.playSound=this.playSound.bind(this)}playSound(t,e,i){h()?d.Z.Sound.play(t,{interrupt:d.Z.Sound.INTERRUPT_EARLY,loop:e,offset:i}):n.play(t)}play(t,e,i,s){let o,n="end"===i?t.totalFrames-1:i,r=new Map(s);this.frameCallMap.has(t)?(o=this.frameCallMap.get(t))&&(o.dispose(),o=new p(t,e,n,r),this.frameCallMap.set(t,o),o.start()):(o=new p(t,e,n,r),this.frameCallMap.set(t,o),o.start())}stopPlayQueue(t){for(let[e,i]of this.frameCallMap)e===t&&(i.dispose(),this.frameCallMap.delete(e))}stopAllPlayQueue(){for(let[t,e]of this.frameCallMap)e.dispose(),this.frameCallMap.delete(t)}playOnce(t){return new Promise(e=>{this.play(t,0,"end",[["end",()=>{e()}]])})}playOnceLabelMC(t,e){return new Promise(i=>{if(this.hasLabel(t,e)){t.gotoAndStop(e);let s=this.getChildAt(t,0);this.play(s,0,"end",[["end",()=>{i()}]])}else i()})}lock(){this.exportRoot.mouseEnabled=!1}unlock(){this.exportRoot.mouseEnabled=!0}getRoot(){return this.exportRoot}getLib(){return this.lib}getStage(){return this.stage}getCanvas(){return this.canvas}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?e.getChildByName(t):this.exportRoot.getChildByName(t)}find(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=(e=i||this.exportRoot).getChildByName(t);if(s)return s;{let i=e.children;for(let e=0;e<i.length;++e){let s=i[e];if(s instanceof d.Z.MovieClip){let e=this.find(t,s);if(e)return e}}}}setHitArea(t){let e=t.nominalBounds,i=new d.Z.Shape;i.graphics.beginFill("#ff0000").drawRect(e.x,e.y,e.width,e.height),t.hitArea=i}getBound(t){let e=t.getBounds();return e||(e=t.nominalBounds),e}getNominalBound(t){return t.nominalBounds}hitTest(t,e,i){if(!t.visible||!t.mouseEnabled)return!1;let s=t.globalToLocal(e,i),o=this.getBound(t);return!!(s.x>=0)&&!!(s.x<=o.width)&&!!(s.y>=0)&&!!(s.y<=o.height)}overlap(t,e){let i=this.setupPoint(t),s=this.setupPoint(e);return!(i.tr.y>s.bl.y)&&!(i.bl.y<s.tr.y)&&!(i.tr.x<s.bl.x)&&!(i.bl.x>s.tr.x)}setupPoint(t){let e=this.getBound(t),i={x:t.x-t.regX,y:t.y-t.regY},s=t.parent.localToGlobal(i.x,i.y);return{tr:{x:s.x+e.width,y:s.y},bl:{x:s.x,y:s.y+e.height}}}disableButton(t){t.alpha=.5,t.mouseEnabled=!1}enableButton(t){t.alpha=1,t.mouseEnabled=!0}isClicked(t,e){if(t.name===e)return!0;let i=t.parent;for(;i;){if(i.name===e)return!0;i=i.parent}return!1}alignInY(t){let e=0,i=0,s=0,o=0;for(let n=0;n<t.length;++n)for(let r=n+1;r<t.length;++r)if(e=Math.floor(t[n].x),s=Math.floor(t[n].y),i=Math.floor(t[r].x),s>(o=Math.floor(t[r].y))){let e=t[n];t[n]=t[r],t[r]=e}else if(5>Math.abs(s-o)&&e>i){let e=t[n];t[n]=t[r],t[r]=e}}alignInX(t){let e=0,i=0,s=0,o=0;for(let n=0;n<t.length;++n)for(let r=n+1;r<t.length;++r)if(e=Math.floor(t[n].x),s=Math.floor(t[n].y),i=Math.floor(t[r].x),o=Math.floor(t[r].y),e>i){let e=t[n];t[n]=t[r],t[r]=e}else if(5>Math.abs(e-i)&&s>o){let e=t[n];t[n]=t[r],t[r]=e}}getMovieClipsByName(t,e){let i=[],s=0;for(;;){let o=this.find(`${t}_${s}`,e);if(!o)break;i.push(o),s++}return i.length,i}getChildAt(t,e){return t.getChildAt(e)}hasLabel(t,e){return t.labels.some(t=>t.label===e)}constructor(t){var e;(0,s._)(this,"args",void 0),(0,s._)(this,"doc",document),(0,s._)(this,"container",void 0),(0,s._)(this,"canvas",void 0),(0,s._)(this,"exportRoot",void 0),(0,s._)(this,"stage",void 0),(0,s._)(this,"lib",void 0),(0,s._)(this,"frameCallMap",new Map),this.args=t;let i=this.doc.querySelector(this.args.node);if(!i)throw Error(`Container not found: ${this.args.node}`);this.container=i,this.container.style.width=`${this.args.canvasSize.w}px`,this.container.style.height=`${this.args.canvasSize.h}px`,this.canvas=this.doc.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.width=this.args.canvasSize.w,this.canvas.height=this.args.canvasSize.h,this.container.appendChild(this.canvas),(e=this.args.src,new Promise((t,i)=>{let s=document.createElement("script");s.src=e,s.async=!1,document.body.appendChild(s),s.addEventListener("load",()=>{t()}),s.addEventListener("error",()=>{i(Error(`${e} \u{C2A4}\u{D06C}\u{B9BD}\u{D2B8} \u{B85C}\u{B4DC} \u{C2E4}\u{D328}`))})})).then(()=>{this.init()}),window.addEventListener("MESSAGE",t=>{let e=t.detail;if("FRAME_CALL_END"===e.message){let t=e.mc;for(let[e]of this.frameCallMap)e===t&&this.frameCallMap.delete(e)}})}}(0,s._)(u,"START","ccstart"),(0,s._)(u,"READY_COMPLETE","ccreadycomplete"),(0,s._)(u,"SCALE_UP",!0);class g{init(){this.setupCC(),this.setupEvent()}reset(){}activate(){this.isActive=!0}deactivate(){this.isActive=!1}hnMessage(t){this.isActive&&t.detail.message===u.READY_COMPLETE&&this.initCC()}setupEvent(){this.messageHandler=this.hnMessage.bind(this),window.addEventListener("MESSAGE",this.messageHandler)}setupCC(){this.props.cc&&(this.cc=new u(this.props.cc))}initCC(){this.cc&&this.cc.start()}playButtonAudio(){n.play("button")}constructor(t){(0,s._)(this,"props",void 0),(0,s._)(this,"root",void 0),(0,s._)(this,"cc",void 0),(0,s._)(this,"isActive",!0),(0,s._)(this,"messageHandler",void 0);let{root:e}=t;this.props=t,this.root=document.querySelector(e)}}class m{init(t){t&&this.props.linkName&&(this.cc=t,this.rootMc=this.cc.getRoot(),this.lib=this.cc.getLib(),this.mc=new this.lib[this.props.linkName]),this.props.root&&(this.root=document.querySelector(this.props.root))}start(){this.cc&&this.rootMc.addChild(this.mc)}clear(){this.cc&&this.rootMc.removeChild(this.mc)}initCC(){}constructor(t){(0,s._)(this,"props",void 0),(0,s._)(this,"root",void 0),(0,s._)(this,"cc",void 0),(0,s._)(this,"rootMc",void 0),(0,s._)(this,"lib",void 0),(0,s._)(this,"mc",void 0),(0,s._)(this,"rootEl",void 0),this.props=t}}var y=i(450);class f{static roundCoord(t){let e=f.COORD_EPS;return Math.round(t/e)*e}static keyOf(t,e){let i=f.roundCoord(t),s=f.roundCoord(e);return`${i.toFixed(3)},${s.toFixed(3)}`}static quantizePoint(t){return{x:f.roundCoord(t.x),y:f.roundCoord(t.y)}}updateCurrentColor(t){this.currentColor=t}updateDrawnLines(t){this.drawnLines=t}updatePolygonColorMap(t){this.polygonColorMap=t}findAndDrawPolygons(){if(!this.svg)return;if(document.querySelector("#svgCanvas").querySelectorAll(".dots circle").forEach(t=>t.classList.add("pe-none")),!this.drawnLines.some(t=>{let e=(t.element.getAttribute("stroke")||"").toLowerCase(),i="true"===t.element.getAttribute("data-boundary");return e&&"transparent"!==e&&"none"!==e&&!i})){this.svg.querySelectorAll("polygon").forEach(t=>t.remove()),this.svgManager&&"function"==typeof this.svgManager.checkBtnOkActive&&this.svgManager.checkBtnOkActive();return}let{points:t,segments:e}=this.splitLinesAtIntersections();if(0===e.length)return;let i=this.buildCoordinateMap(t),{neighbors:s,directedEdges:o}=this.buildNeighborsAndEdges(e,i);this.sortNeighborsClockwise(s);let n=this.traceFaces(s,i,o);if((n=n.filter(t=>f.isSimpleNonDegeneratePolygon(t))).length>1&&(n.length,(n=this.removeOuterHull(n)).length>1)){let t=n.map(t=>f.getPolygonArea(t)),e=Math.max(...t),i=t.indexOf(e),s=t.filter((t,e)=>e!==i);e>2*(s.length>0?s.reduce((t,e)=>t+e,0)/s.length:0)&&n.splice(i,1)}this.renderPolygons(n),this.svgManager&&"function"==typeof this.svgManager.sortCircleElements&&this.svgManager.sortCircleElements()}splitLinesAtIntersections(){let t=this.drawnLines.map(t=>({x1:t.start.cx,y1:t.start.cy,x2:t.end.cx,y2:t.end.cy})),e=new Set;t.forEach(t=>{e.add(f.keyOf(t.x1,t.y1)),e.add(f.keyOf(t.x2,t.y2))});let i=[],s=new Set;for(let o=0;o<t.length;o++)for(let n=o+1;n<t.length;n++){let r=f.getLineIntersection(t[o],t[n]);if(r){let t=f.keyOf(r.x,r.y);s.has(t)||(s.add(t),i.push(r)),e.add(t)}}let o=[];for(let e of t){let t=[{x:e.x1,y:e.y1},{x:e.x2,y:e.y2},...i.filter(t=>f.isPointOnSegment(t,e))],s=[],n=new Set;for(let e of t){let t=f.keyOf(e.x,e.y);n.has(t)||(n.add(t),s.push(e))}let r=e.x2-e.x1,a=e.y2-e.y1,l=r*r+a*a||1,h=t=>((t.x-e.x1)*r+(t.y-e.y1)*a)/l;s.sort((t,e)=>h(t)-h(e));for(let t=0;t<s.length-1;t++){let e=f.quantizePoint(s[t]),i=f.quantizePoint(s[t+1]);o.push({x1:e.x,y1:e.y,x2:i.x,y2:i.y})}}return{points:Array.from(e),segments:o}}static getLineIntersection(t,e){let i=(t.x2-t.x1)*(e.y2-e.y1)-(t.y2-t.y1)*(e.x2-e.x1);if(0===i)return null;let s=((e.x1-t.x1)*(e.y2-e.y1)-(e.y1-t.y1)*(e.x2-e.x1))/i,o=((e.x1-t.x1)*(t.y2-t.y1)-(e.y1-t.y1)*(t.x2-t.x1))/i;if(s<-1e-9||s>1.000000001||o<-1e-9||o>1.000000001)return null;let n=Math.max(0,Math.min(1,s));return{x:t.x1+n*(t.x2-t.x1),y:t.y1+n*(t.y2-t.y1)}}static isPointOnSegment(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6,s=Math.min(e.x1,e.x2)-i,o=Math.max(e.x1,e.x2)+i,n=Math.min(e.y1,e.y2)-i,r=Math.max(e.y1,e.y2)+i;return!(Math.abs((e.x2-e.x1)*(t.y-e.y1)-(e.y2-e.y1)*(t.x-e.x1))>i)&&t.x>=s&&t.x<=o&&t.y>=n&&t.y<=r}buildCoordinateMap(t){let e=new Map;for(let i of t){let[t,s]=i.split(",").map(Number);e.set(i,{x:t,y:s})}return e}buildNeighborsAndEdges(t,e){let i=new Map,s=(t,s)=>{i.has(t)||i.set(t,[]);let o=e.get(t),n=e.get(s),r=Math.atan2(n.y-o.y,n.x-o.x);i.get(t).push({id:s,angle:r})},o=[];for(let i of t){let t=f.keyOf(i.x1,i.y1),n=f.keyOf(i.x2,i.y2);e.has(t)&&e.has(n)&&(s(t,n),s(n,t),o.push({u:t,v:n}),o.push({u:n,v:t}))}return{neighbors:i,directedEdges:o}}sortNeighborsClockwise(t){for(let[e,i]of t.entries())i.sort((t,e)=>t.angle-e.angle),t.set(e,i)}traceFaces(t,e,i){let s=(t,e)=>`${t}->${e}`,o=new Set,n=new Set,r=[],a=(i,s)=>{let o=t.get(s);if(!o||0===o.length)return null;let n=e.get(s),r=e.get(i),a=Math.atan2(r.y-n.y,r.x-n.x),l=-1;for(let t=0;t<o.length;t++)if(o[t].id===i){l=t;break}if(-1===l){let t=-1,e=1/0;for(let i=0;i<o.length;i++){let s=(a-o[i].angle+3*Math.PI)%(2*Math.PI);s>0&&s<e&&(e=s,t=i)}return -1===t?o[0].id:o[t].id}let h=(l-1+o.length)%o.length;return o[h].id};for(let{u:t,v:e}of i){let l=s(t,e);if(o.has(l))continue;let h=t,c=e,d=[t,e],p=0,u=Math.max(60,2*i.length);for(;p++<u;){let t=a(h,c);if(!t)break;if(t===d[0]){let t=d.slice(0);if(t.length>=3){let e=f.normalizePolygon(t);if(!n.has(e)){n.add(e),r.push(t);for(let e=0;e<t.length;e++){let i=t[e],n=t[(e+1)%t.length];o.add(s(i,n))}}}break}h=c,c=t,d.push(c)}}return r}static normalizePolygon(t){let e=t.reduce((t,e,i,s)=>e<s[t]?i:t,0),i=t.length,s=Array.from({length:i},(s,o)=>t[(e+o)%i]),o=Array.from({length:i},(s,o)=>t[(e-o+i)%i]);return[s.join("|"),o.join("|")].sort()[0]}static isSimpleNonDegeneratePolygon(t){if(!t||t.length<3)return!1;let e=new Map;for(let i=0;i<t.length;i++){let s=t[i];if(e.has(s)){if(e.get(s)!==i-1)return!1}else e.set(s,i)}if(1e-6>f.getPolygonArea(t))return!1;let i=t.length,s=t=>{let[e,i]=t.split(",").map(Number);return{x:e,y:i}},o=Array.from({length:i},(e,o)=>({a:s(t[o]),b:s(t[(o+1)%i])})),n=(e,s)=>{if(e===s)return!0;let o=(e+1)%i,n=(s+1)%i;return e===n||s===o||f.isSamePoint(t[e],t[s])||f.isSamePoint(t[e],t[n])||f.isSamePoint(t[o],t[s])||f.isSamePoint(t[o],t[n])},r=(t,e,i)=>{let s=(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y);return 1e-9>Math.abs(s)?0:s>0?1:2},a=(t,e,i)=>Math.min(t.x,i.x)-1e-9<=e.x&&e.x<=Math.max(t.x,i.x)+1e-9&&Math.min(t.y,i.y)-1e-9<=e.y&&e.y<=Math.max(t.y,i.y)+1e-9,l=(t,e,i,s)=>{let o=r(t,e,i),n=r(t,e,s),l=r(i,s,t),h=r(i,s,e);return!!(o!==n&&l!==h||0===o&&a(t,i,e)||0===n&&a(t,s,e)||0===l&&a(i,t,s)||0===h&&a(i,e,s))};for(let t=0;t<i;t++)for(let e=t+1;e<i;e++){if(n(t,e))continue;let i=o[t],s=o[e];if(l(i.a,i.b,s.a,s.b))return!1}return!0}static getPolygonArea(t){let e=0;for(let i=0;i<t.length;i++){let[s,o]=t[i].split(",").map(Number),[n,r]=t[(i+1)%t.length].split(",").map(Number);e+=s*r-n*o}return Math.abs(e/2)}static isSamePoint(t,e){return t===e}removeOuterHull(t){if(t.length<=1)return t;let e=t.length,i=t.map(t=>f.getPolygonArea(t)),s=Math.max(...i);if(s>3*Math.min(...i)){let e=i.indexOf(s),o=t.slice();return o.splice(e,1),o}let o=t.map(t=>f.getPolygonCentroid(t)),n=Array(e).fill(0),r=Array(e).fill(0);for(let i=0;i<e;i++)for(let s=0;s<e;s++)i!==s&&f.isPointInPolygon(o[s],t[i])&&(n[i]+=1,r[s]+=1);let a=n.findIndex((t,i)=>t===e-1&&0===r[i]);if(-1!==a){let e=t.slice();return e.splice(a,1),e}let l=this.findOuterPolygonByVertexContainment(t);if(-1!==l){let e=t.slice();return e.splice(l,1),e}let h=-1,c=-1/0;for(let i=0;i<e;i++){let e=f.getPolygonArea(t[i]);e>c&&(c=e,h=i)}if(-1!==h){let e=t.slice();return e.splice(h,1),e}return t}findOuterPolygonByVertexContainment(t){let e=t.length,i=-1,s=-1;for(let o=0;o<e;o++){let n=t[o],r=0;for(let i=0;i<e;i++)if(o!==i)for(let e of t[i]){let[t,i]=e.split(",").map(Number);f.isPointInPolygon({x:t,y:i},n)&&r++}r>i&&(i=r,s=o)}return i>=.8*t.reduce((t,e,i)=>i===s?t:t+e.length,0)?s:-1}calculateOuterScores(t){let e=t.length,i=Array(e).fill(0);for(let s=0;s<e;s++){let o=t[s],n=0,r=0;for(let i=0;i<e;i++)if(s!==i)for(let e of t[i]){let[t,i]=e.split(",").map(Number);f.isPointInPolygon({x:t,y:i},o)&&n++,r++}let a=r>0?n/r:0,l=f.getPolygonArea(o);i[s]=(1-a)*Math.sqrt(l)}return i}static getPolygonCentroid(t){let e=0,i=0,s=0;for(let o=0;o<t.length;o++){let[n,r]=t[o].split(",").map(Number),[a,l]=t[(o+1)%t.length].split(",").map(Number),h=n*l-a*r;e+=h,i+=(n+a)*h,s+=(r+l)*h}if(1e-9>Math.abs(e*=.5)){let e=0,i=0;for(let s=0;s<t.length;s++){let[o,n]=t[s].split(",").map(Number);e+=o,i+=n}return{x:e/t.length,y:i/t.length}}return{x:i/=6*e,y:s/=6*e}}static isPointInPolygon(t,e){let i=t.x,s=t.y,o=!1;for(let t=0,n=e.length-1;t<e.length;n=t++){let[r,a]=e[t].split(",").map(Number),[l,h]=e[n].split(",").map(Number);if(this.isPointOnSegment({x:i,y:s},{x1:r,y1:a,x2:l,y2:h}))return!0;a>s!=h>s&&i<(l-r)*(s-a)/(h-a||1e-12)+r&&(o=!o)}return o}renderPolygons(t){if(!this.svg)return;if(0===t.length){this.svg.querySelectorAll("polygon").forEach(t=>t.remove()),this.svgManager&&"function"==typeof this.svgManager.checkBtnOkActive&&this.svgManager.checkBtnOkActive();return}let e=[];this.svg.querySelectorAll("polygon").forEach(t=>{let i=t.getAttribute("points"),s=t.getAttribute("fill");if(i&&s&&"transparent"!==s&&"none"!==s){let t=i.trim().split(/\s+/);e.push({points:t,fill:s}),this.polygonColorMap.set(i,s);let o=f.normalizePolygon(t);this.polygonColorMap.set(o,s)}}),this.svg.querySelectorAll("polygon").forEach(t=>t.remove()),t.forEach((t,i)=>{let s=t.join(" "),o=document.createElementNS("http://www.w3.org/2000/svg","polygon");o.setAttribute("points",s);let n=f.normalizePolygon(t),r=this.polygonColorMap.get(s)||this.polygonColorMap.get(n);if(!r||"transparent"===r){let i=this.findInheritedColor(t,e);i&&(r=i)}o.setAttribute("fill",r||"transparent"),o.setAttribute("stroke","none"),o.setAttribute("pointer-events","visiblePainted"),o.setAttribute("data-polygon-id",i.toString());let a=this;o.addEventListener("click",function(e){if(!a.isPaintModeActive())return void e.stopPropagation();let i=this.getAttribute("fill")||"transparent",o=a.getCurrentStrokeColor(),n=f.normalizePolygon(t);i===o?(this.setAttribute("fill","transparent"),a.polygonColorMap.set(s,"transparent"),a.polygonColorMap.set(n,"transparent")):(this.setAttribute("fill",o),a.polygonColorMap.set(s,o),a.polygonColorMap.set(n,o)),a.svgManager&&"function"==typeof a.svgManager.checkBtnOkActive&&a.svgManager.checkBtnOkActive(),e.stopPropagation()}),this.svg.appendChild(o)}),this.assignPolygonIdsToLines(t);let i=this.findClosedPolygonsFromIdLessColoredLines(t),s=[];if(i.length>0){let o=t.length;s=i,i.length>1&&(i.length,s=this.removeOuterHull(i)),s.forEach((t,i)=>{let s=t.join(" "),n=document.createElementNS("http://www.w3.org/2000/svg","polygon");n.setAttribute("points",s);let r=f.normalizePolygon(t),a=this.polygonColorMap.get(s)||this.polygonColorMap.get(r);if(!a||"transparent"===a){let i=this.findInheritedColor(t,e);i&&(a=i)}n.setAttribute("fill",a||"transparent"),n.setAttribute("stroke","none"),n.setAttribute("pointer-events","visiblePainted"),n.setAttribute("data-polygon-id",(o+i).toString());let l=this,h=f.normalizePolygon(t);n.addEventListener("click",function(t){if(!l.isPaintModeActive())return void t.stopPropagation();let e=this.getAttribute("fill")||"transparent",i=l.getCurrentStrokeColor();e===i?(this.setAttribute("fill","transparent"),l.polygonColorMap.set(s,"transparent"),l.polygonColorMap.set(h,"transparent")):(this.setAttribute("fill",i),l.polygonColorMap.set(s,i),l.polygonColorMap.set(h,i)),l.svgManager&&"function"==typeof l.svgManager.checkBtnOkActive&&l.svgManager.checkBtnOkActive(),t.stopPropagation()}),this.svg.appendChild(n)}),this.assignPolygonIdsToLines(t.concat(s))}t.length,s.length,this.svgManager&&"function"==typeof this.svgManager.checkBtnOkActive&&this.svgManager.checkBtnOkActive()}findClosedPolygonsFromIdLessColoredLines(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!this.svg)return[];let e=Array.from(this.svg.querySelectorAll("line")).filter(t=>{let e=(t.getAttribute("stroke")||"").toLowerCase(),i="true"===t.getAttribute("data-boundary");return e&&"transparent"!==e&&"none"!==e&&!i}),i=new Map;e.forEach(t=>{let e=parseFloat(t.getAttribute("x1")||"0"),s=parseFloat(t.getAttribute("y1")||"0"),o=parseFloat(t.getAttribute("x2")||"0"),n=parseFloat(t.getAttribute("y2")||"0"),r=f.quantizePoint({x:e,y:s}),a=f.quantizePoint({x:o,y:n}),l=`${r.x},${r.y}-${a.x},${a.y}`,h=`${a.x},${a.y}-${r.x},${r.y}`;i.has(l)||i.has(h)||i.set(l,t)});let s=Array.from(i.values());if(s.length<3)return[];let o=s.map(t=>{let e=parseFloat(t.getAttribute("x1")||"0"),i=parseFloat(t.getAttribute("y1")||"0"),s=parseFloat(t.getAttribute("x2")||"0"),o=parseFloat(t.getAttribute("y2")||"0"),n=f.quantizePoint({x:e,y:i}),r=f.quantizePoint({x:s,y:o});return{x1:n.x,y1:n.y,x2:r.x,y2:r.y}}).filter(t=>t.x1!==t.x2||t.y1!==t.y2);if(o.length<3)return[];let n=new Set;o.forEach(t=>{n.add(f.keyOf(t.x1,t.y1)),n.add(f.keyOf(t.x2,t.y2))});let r=[],a=new Set;for(let t=0;t<o.length;t++)for(let e=t+1;e<o.length;e++){let i=f.getLineIntersection(o[t],o[e]);if(i){let t=f.keyOf(i.x,i.y);a.has(t)||(a.add(t),r.push(i)),n.add(t)}}let l=[];for(let t of o){let e=[{x:t.x1,y:t.y1},{x:t.x2,y:t.y2},...r.filter(e=>f.isPointOnSegment(e,t))],i=[],s=new Set;for(let t of e){let e=f.keyOf(t.x,t.y);s.has(e)||(s.add(e),i.push(t))}let o=t.x2-t.x1,n=t.y2-t.y1,a=o*o+n*n||1,h=e=>((e.x-t.x1)*o+(e.y-t.y1)*n)/a;i.sort((t,e)=>h(t)-h(e));for(let t=0;t<i.length-1;t++){let e=f.quantizePoint(i[t]),s=f.quantizePoint(i[t+1]);l.push({x1:e.x,y1:e.y,x2:s.x,y2:s.y})}}if(l.length<3)return[];let h=Array.from(n),c=this.buildCoordinateMap(h),{neighbors:d,directedEdges:p}=this.buildNeighborsAndEdges(l,c);this.sortNeighborsClockwise(d);let u=this.traceFaces(d,c,p);if(0===(u=u.filter(t=>f.isSimpleNonDegeneratePolygon(t))).length)return[];let g=new Set(Array.from(this.svg.querySelectorAll("polygon")).map(t=>t.getAttribute("points")||""));return t.forEach(t=>{g.add(t.join(" "))}),u.filter(t=>{let e=t.join(" "),i=f.normalizePolygon(t),s=g.has(e),o=Array.from(g).some(t=>{let e=t.trim().split(/\s+/);return f.normalizePolygon(e)===i});return!s&&!o})}assignPolygonIdsToLines(t){if(!this.svg)return;this.svg.querySelectorAll("line").forEach(t=>{t.removeAttribute("data-polygon-id")});let e=Array.from(this.svg.querySelectorAll("line")).filter(t=>{let e=(t.getAttribute("stroke")||"").toLowerCase(),i="true"===t.getAttribute("data-boundary");return e&&"transparent"!==e&&"none"!==e&&!i}),i=this.drawnLines.map(t=>t.element),s=new Map;e.forEach(t=>{let e=parseFloat(t.getAttribute("x1")||"0"),i=parseFloat(t.getAttribute("y1")||"0"),o=parseFloat(t.getAttribute("x2")||"0"),n=parseFloat(t.getAttribute("y2")||"0"),r=f.quantizePoint({x:e,y:i}),a=f.quantizePoint({x:o,y:n}),l=`${r.x},${r.y}-${a.x},${a.y}`,h=`${a.x},${a.y}-${r.x},${r.y}`;s.has(l)||s.has(h)||s.set(l,t)}),i.forEach(t=>{let e=parseFloat(t.getAttribute("x1")||"0"),i=parseFloat(t.getAttribute("y1")||"0"),o=parseFloat(t.getAttribute("x2")||"0"),n=parseFloat(t.getAttribute("y2")||"0"),r=f.quantizePoint({x:e,y:i}),a=f.quantizePoint({x:o,y:n}),l=`${r.x},${r.y}-${a.x},${a.y}`,h=`${a.x},${a.y}-${r.x},${r.y}`;s.has(l)||s.has(h)||s.set(l,t)});let o=Array.from(s.values()).map(t=>({start:{x:parseFloat(t.getAttribute("x1")||"0"),y:parseFloat(t.getAttribute("y1")||"0")},end:{x:parseFloat(t.getAttribute("x2")||"0"),y:parseFloat(t.getAttribute("y2")||"0")},element:t}));t.forEach((t,e)=>{for(let i=0;i<t.length;i++){let s=t[i],n=t[(i+1)%t.length],r=this.findOriginalLineForSegment(s,n,o);if(r){let t=r.getAttribute("data-polygon-id");if(t){let i=t.split(",").map(t=>t.trim());i.includes(e.toString())||(i.push(e.toString()),r.setAttribute("data-polygon-id",i.join(",")))}else r.setAttribute("data-polygon-id",e.toString())}}})}findOriginalLineForSegment(t,e,i){let[s,o]=t.split(",").map(Number),[n,r]=e.split(",").map(Number);for(let t of i)if(this.isSegmentOnLine({x:s,y:o},{x:n,y:r},t.start,t.end,2))return t.element;return null}isSegmentOnLine(t,e,i,s,o){let n=this.isPointOnLine(t,i,s,o),r=this.isPointOnLine(e,i,s,o);return n&&r}isPointOnLine(t,e,i,s){return f.getDistanceToLine(e,i,t)<=s}static getDistanceToLine(t,e,i){let s,o,n=i.x-t.x,r=i.y-t.y,a=e.x-t.x,l=e.y-t.y,h=a*a+l*l;if(0===h)return Math.sqrt(n*n+r*r);let c=(n*a+r*l)/h;c<0?(s=t.x,o=t.y):c>1?(s=e.x,o=e.y):(s=t.x+c*a,o=t.y+c*l);let d=i.x-s,p=i.y-o;return Math.sqrt(d*d+p*p)}findInheritedColor(t,e){let i=f.getPolygonCentroid(t),s=t.map(t=>{let[e,i]=t.split(",").map(Number);return{x:e,y:i}});for(let t of e)if(f.isPointInPolygon(i,t.points)&&s.every(e=>f.isPointInPolygon(e,t.points)))return t.fill;for(let t of e)if(f.isPointInPolygon(i,t.points))return t.fill;return null}isPaintModeActive(){let t=document.querySelector(".paint-mode");return t&&t.classList.contains("active")}getCurrentStrokeColor(){return this.getColorCode(this.currentColor)}getColorCode(t){return({black:"#000",red:"#f53a3a",orange:"#ff760b",yellow:"#ffc400",lgreen:"#bcd011",green:"#27aa2b",sky:"#41a5ff",blue:"#3568f3",lpurple:"#9664e0",purple:"#624093",lbrown:"#b8793d",brown:"#9f3e00"})[t]||"#000"}constructor(t,e,i,o,n){(0,s._)(this,"svg",void 0),(0,s._)(this,"drawnLines",void 0),(0,s._)(this,"polygonColorMap",void 0),(0,s._)(this,"currentColor",void 0),(0,s._)(this,"svgManager",void 0),this.svg=t,this.drawnLines=e,this.polygonColorMap=i,this.currentColor=o,this.svgManager=n}}(0,s._)(f,"COORD_EPS",.001);class b{hnClick(t){let e=t.target,i=e.btnType;if(n.play("button"),this.colors.includes(i)){this.colors.forEach(t=>{let e=document.querySelector(`.color-${t}`);e&&e.classList.remove("active")}),e.classList.add("active"),this.currentColor=i,this.polygonsManager.updateCurrentColor(this.currentColor);let t=this.modeList.map(t=>document.querySelector(`.${t}-mode`)).find(t=>t&&t.classList.contains("active"));if(t){let e=this.getCurrentStrokeColor();t.style.background=e,t.style.color="#fff"}return}if(this.modeList.includes(i)){this.modeList.forEach(t=>{let e=document.querySelector(`.${t}-mode`);e&&(e.classList.remove("active"),e.style.background="",e.style.color="")}),e.classList.add("active");let t=this.getCurrentStrokeColor();e.style.background=t,e.style.color="#fff","paint"===i?(this.clearSquareMode(),this.polygonsManager.updateDrawnLines(this.drawnLines),this.polygonsManager.findAndDrawPolygons(),this.sortSvgElements()):"line"===i?(this.clearSquareMode(),this.rectNone()):"square"===i&&(this.drawAllSquares(),this.rectAuto());return}}checkBtnOkActive(){let t=document.querySelector(".btn-ok"),e=this.svg;if(!t||!e)return;let i=Array.from(e.querySelectorAll("polygon")).some(t=>{let e=t.getAttribute("fill");return e&&"transparent"!==e&&"none"!==e}),s=Array.from(e.querySelectorAll("rect")).some(t=>{let e=t.getAttribute("fill");return e&&"transparent"!==e&&"none"!==e}),o=Array.from(e.querySelectorAll("line")).some(t=>{let e=t.getAttribute("stroke");return e&&"transparent"!==e&&"none"!==e});i||s||o?t.classList.remove("dim"):t.classList.add("dim")}initDots(){if(this.svg){this.dotsGroup=document.createElementNS("http://www.w3.org/2000/svg","g"),this.dotsGroup.setAttribute("class","dots");for(let t=0;t<6;t++)for(let e=0;e<6;e++){let i=this.leftOffset+e*this.spacing,s=this.topOffset+t*this.spacing,o=this.createSvgCircle(i,s,this.dotRadius);o.dataset.index=this.dots.length.toString(),this.dotsGroup.appendChild(o),this.dots.push({cx:i,cy:s,element:o})}this.svg.appendChild(this.dotsGroup),this.dots.forEach(t=>{t.element.addEventListener("pointerdown",e=>{if(e.preventDefault(),!this.isLineModeActive||this.isDrawing)return;this.isDrawing=!0,this.startDot=t,this.selectedDots.push(t);let i=t.element,s=this.getCurrentStrokeColor();i.style.fill=s,i.classList.add("active"),this.animateDot(i,1.5*this.dotRadius),this.previewLine=this.createSvgLine(t.cx,t.cy,t.cx,t.cy),this.svg.appendChild(this.previewLine),this.previewCircle=this.createSvgCircle(t.cx,t.cy,1.5*this.dotRadius,{opacity:"0.7",className:"active"}),this.previewCircle.style.fill=s,this.svg.appendChild(this.previewCircle)})}),this.svg.addEventListener("pointerup",t=>this.onPointerUp(t)),this.svg.addEventListener("pointermove",t=>this.onPointerMove(t)),this.svg.addEventListener("pointerleave",()=>this.endDrag())}}createSvgCircle(t,e,i,s){let o=document.createElementNS("http://www.w3.org/2000/svg","circle");return o.setAttribute("cx",t.toString()),o.setAttribute("cy",e.toString()),o.setAttribute("r",i.toString()),s&&(s.fill&&o.setAttribute("fill",s.fill),s.opacity&&o.setAttribute("opacity",s.opacity),s.className&&o.classList.add(s.className)),o}animateDot(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.3,s=y.ZP.timeline();y.ZP.killTweensOf(s),e>parseFloat(t.getAttribute("r")||"0")?this.dotsGroup&&t.parentNode===this.dotsGroup&&this.dotsGroup.appendChild(t):this.restoreDotToOriginalPosition(t),s.to(t,{duration:i,attr:{r:e},ease:"power2.out"})}restoreDotToOriginalPosition(t){if(!this.dotsGroup)return;let e=parseInt(t.dataset.index||"0"),i=Array.from(this.dotsGroup.querySelectorAll("circle")).filter(t=>void 0!==t.dataset.index).sort((t,e)=>parseInt(t.dataset.index||"0")-parseInt(e.dataset.index||"0")),s=i.findIndex(t=>parseInt(t.dataset.index||"0")===e);if(-1!==s)if(0===s){let e=this.dotsGroup.firstChild;e&&e!==t&&this.dotsGroup.insertBefore(t,e)}else{let e=i[s-1];e&&e.nextSibling!==t&&this.dotsGroup.insertBefore(t,e.nextSibling)}}onPointerUp(t){if(!this.svg)return;if(!this.isLineModeActive)return void this.endDrag();let e=this.svg.createSVGPoint();e.x=t.clientX,e.y=t.clientY;let i=this.svg.getScreenCTM();if(!i)return;let s=e.matrixTransform(i.inverse()),o=this.dots.find(t=>{let e=t.cx-s.x,i=t.cy-s.y;return 10>=Math.sqrt(e*e+i*i)});if(!o||!this.isDrawing||!this.startDot)return void this.endDrag();if(o&&(0===this.selectedDots.length||this.selectedDots[this.selectedDots.length-1]!==o)){let t=this.selectedDots.length>0?this.selectedDots[this.selectedDots.length-1]:this.startDot;if(!t)return void this.endDrag();this.drawnLines.some(e=>e.start===t&&e.end===o||e.start===o&&e.end===t)?this.changeLineColor(t,o):(this.drawLine(t,o),this.selectedDots.push(o))}this.endDrag()}onPointerMove(t){if(this.svg&&this.isLineModeActive&&this.isDrawing&&this.previewLine){let e=this.svg.getBoundingClientRect();if(t.clientX<e.left||t.clientX>e.right||t.clientY<e.top||t.clientY>e.bottom)return void this.endDrag();let i=this.svg.createSVGPoint();i.x=t.clientX,i.y=t.clientY;let s=this.svg.getScreenCTM();if(!s)return;let o=i.matrixTransform(s.inverse());this.previewLine.setAttribute("x2",o.x.toString()),this.previewLine.setAttribute("y2",o.y.toString()),this.previewCircle&&(this.previewCircle.setAttribute("cx",o.x.toString()),this.previewCircle.setAttribute("cy",o.y.toString()))}}endDrag(){this.isDrawing=!1,this.startDot=null,this.previewLine&&this.svg&&(this.svg.removeChild(this.previewLine),this.previewLine=null),this.previewCircle&&this.svg&&(this.svg.removeChild(this.previewCircle),this.previewCircle=null),this.selectedDots=[],this.dots.forEach(t=>{let e=t.element;e.style.removeProperty("fill"),e.setAttribute("fill","#000000"),e.classList.remove("active"),this.animateDot(e,this.dotRadius)}),this.checkBtnOkActive(),this.sortSvgElements(),this.sortCircleElements()}createSvgLine(t,e,i,s,o){let n=document.createElementNS("http://www.w3.org/2000/svg","line");n.setAttribute("x1",t.toString()),n.setAttribute("y1",e.toString()),n.setAttribute("x2",i.toString()),n.setAttribute("y2",s.toString());let r={...{stroke:this.getCurrentStrokeColor(),strokeWidth:"3.5",strokeLinecap:"round"},...o};return n.setAttribute("stroke",r.stroke),n.setAttribute("stroke-width",r.strokeWidth),n.setAttribute("stroke-linecap",r.strokeLinecap),n}drawLine(t,e){if(!this.svg)return;let i=this.createSvgLine(t.cx,t.cy,e.cx,e.cy);this.svg.appendChild(i),this.drawnLines.push({element:i,start:t,end:e}),this.polygonsManager.updateDrawnLines(this.drawnLines)}sortSvgElements(){this.svg&&Array.from(this.svg.querySelectorAll("line")).filter(t=>{let e=t.getAttribute("stroke");return e&&"transparent"!==e}).forEach(t=>{this.svg.appendChild(t)})}sortCircleElements(){this.svg&&this.dotsGroup&&this.svg.appendChild(this.dotsGroup)}changeLineColor(t,e){let i=this.drawnLines.find(i=>i.start===t&&i.end===e||i.start===e&&i.end===t);if(i){let t=this.getCurrentStrokeColor();i.element.setAttribute("stroke",t),this.svg&&i.element.parentNode===this.svg&&this.svg.appendChild(i.element)}}getCurrentStrokeColor(){return this.getColorCode(this.currentColor)}getColorCode(t){return({black:"#000",red:"#f53a3a",orange:"#ff760b",yellow:"#ffc400",lgreen:"#bcd011",green:"#27aa2b",sky:"#41a5ff",blue:"#3568f3",lpurple:"#9664e0",purple:"#624093",lbrown:"#b8793d",brown:"#9f3e00"})[t]||"#000"}setPaintbucket(){this.colors=["black","red","orange","yellow","lgreen","green","sky","blue","lpurple","purple","lbrown","brown"],this.colors.forEach(t=>{let e=document.querySelector(`.color-${t}`);e&&(e.btnType=t,e.addEventListener("click",this.bindClick),this[t]=e)})}setMakeMode(){this.modeList=["line","paint","square"],this.modeList.forEach(t=>{let e=document.querySelector(`.${t}-mode`);e&&(e.btnType=t,e.addEventListener("click",this.bindClick),this[t]=e)})}drawAllSquares(){if(this.svg){this.clearSquareMode();for(let t=0;t<5;t++)for(let e=0;e<5;e++){let i=(t,e)=>6*t+e,s=this.dots[i(t,e)],o=this.dots[i(t,e+1)],n=this.dots[i(t+1,e)],r=this.dots[i(t+1,e+1)],a=(t,e,i,s)=>{let o=this.createSvgLine(t,e,i,s,{stroke:"transparent",strokeWidth:"4"});this.svg.appendChild(o),this.squareLines.push(o)};a(s.cx,s.cy,o.cx,o.cy),a(o.cx,o.cy,r.cx,r.cy),a(r.cx,r.cy,n.cx,n.cy),a(n.cx,n.cy,s.cx,s.cy);let l=document.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("x",s.cx.toString()),l.setAttribute("y",s.cy.toString()),l.setAttribute("width",(o.cx-s.cx).toString()),l.setAttribute("height",(n.cy-s.cy).toString());let h=`${s.cx},${s.cy}|${o.cx},${o.cy}|${r.cx},${r.cy}|${n.cx},${n.cy}`;l.setAttribute("fill","transparent"),l.setAttribute("stroke","none"),l.setAttribute("pointer-events","visiblePainted"),l.addEventListener("click",t=>{if(!this.isSquareModeActive)return;let e=l.getAttribute("fill")||"transparent",i=this.getCurrentStrokeColor();e===i?(l.setAttribute("fill","transparent"),this.polygonColorMap.set(h,"transparent")):(l.setAttribute("fill",i),this.polygonColorMap.set(h,i)),this.svg.removeChild(l),this.appendRectAfterPolygons(l),this.checkBtnOkActive(),this.sortSvgElements(),t.stopPropagation()}),this.appendRectAfterPolygons(l),this.squareRects.push(l)}}}clearSquareMode(){this.svg&&(this.squareLines.forEach(t=>t.remove()),this.squareRects.forEach(t=>{"transparent"!==t.getAttribute("fill")&&t.getAttribute("fill")||t.remove()}),this.squareLines=[],this.squareRects=this.squareRects.filter(t=>"transparent"!==t.getAttribute("fill")&&t.getAttribute("fill")))}appendRectAfterPolygons(t){if(!this.svg)return;let e=Array.from(this.svg.querySelectorAll("polygon"));if(e.length>0){let i=e[e.length-1];this.svg.insertBefore(t,i.nextSibling)}else this.svg.appendChild(t)}rectNone(){let t=document.querySelector("#svgCanvas"),e=t.querySelectorAll("rect"),i=t.querySelectorAll("circle");e.forEach(t=>t.classList.add("pe-none")),i.forEach(t=>t.classList.remove("pe-none"))}rectAuto(){let t=document.querySelector("#svgCanvas"),e=t.querySelectorAll("rect"),i=t.querySelectorAll("circle");e.forEach(t=>t.classList.remove("pe-none")),i.forEach(t=>t.classList.add("pe-none"))}async exportImageAndSize(){if(!this.svg)return null;let t=document.querySelector(".shape-box"),e=null==t?void 0:t.querySelector("svg");if(!e)return null;e.querySelectorAll("line, rect, polygon").forEach(t=>t.remove());let i=[];this.svg.querySelectorAll("line, rect, polygon").forEach(t=>{let e=t.tagName,s=!1;if("rect"===e||"polygon"===e){let e=t.getAttribute("fill");e&&"transparent"!==e&&"none"!==e&&(s=!0)}else if("line"===e){let e=t.getAttribute("stroke");e&&"transparent"!==e&&"none"!==e&&(s=!0)}s&&i.push(t)});let s={spacing:74.5,leftOffset:14.7,topOffset:12.7},o={spacing:30,leftOffset:0,topOffset:0},n=(t,e)=>{let i=(t-s.leftOffset)/s.spacing,n=(e-s.topOffset)/s.spacing;return{x:i*o.spacing+o.leftOffset,y:n*o.spacing+o.topOffset}},r=document.createElementNS("http://www.w3.org/2000/svg","g");return i.forEach(t=>{let e=t.cloneNode(!0),i=e.tagName;if("line"===i){let t=parseFloat(e.getAttribute("x1")||"0"),i=parseFloat(e.getAttribute("y1")||"0"),r=parseFloat(e.getAttribute("x2")||"0"),a=parseFloat(e.getAttribute("y2")||"0"),l=n(t,i),h=n(r,a);e.setAttribute("x1",l.x.toString()),e.setAttribute("y1",l.y.toString()),e.setAttribute("x2",h.x.toString()),e.setAttribute("y2",h.y.toString());let c=parseFloat(e.getAttribute("stroke-width")||"3")*(o.spacing/s.spacing);e.setAttribute("stroke-width",c.toString())}else if("rect"===i){let t=parseFloat(e.getAttribute("x")||"0"),i=parseFloat(e.getAttribute("y")||"0"),s=parseFloat(e.getAttribute("width")||"0"),o=parseFloat(e.getAttribute("height")||"0"),r=n(t,i),a=n(t+s,i+o);e.setAttribute("x",r.x.toString()),e.setAttribute("y",r.y.toString()),e.setAttribute("width",(a.x-r.x).toString()),e.setAttribute("height",(a.y-r.y).toString())}else if("polygon"===i){let t=(e.getAttribute("points")||"").split(" ").map(t=>{let[e,i]=t.split(",").map(Number),s=n(e,i);return`${s.x},${s.y}`}).join(" ");e.setAttribute("points",t)}r.appendChild(e)}),i.length>0&&(e.appendChild(r),e.querySelectorAll("circle").forEach(t=>t.remove())),{success:!0}}get isLineModeActive(){return this.line&&this.line.classList.contains("active")}get isPaintModeActive(){return this.paint&&this.paint.classList.contains("active")}get isSquareModeActive(){return this.square&&this.square.classList.contains("active")}clearAllLines(){var t;this.svg&&(this.drawnLines.forEach(t=>{t.element.parentNode&&t.element.parentNode.removeChild(t.element)}),this.drawnLines=[],this.polygonsManager.updateDrawnLines(this.drawnLines),this.svg.querySelectorAll("polygon").forEach(t=>t.remove()),this.dots.forEach(t=>{t.element.setAttribute("fill","#666"),t.element.classList.remove("active")}),this.svg.querySelectorAll("rect").forEach(t=>t.remove()),this.svg.querySelectorAll("line").forEach(t=>t.remove()),this.clearSquareMode(),this.polygonColorMap.clear(),this.polygonsManager.updatePolygonColorMap(this.polygonColorMap),this.checkBtnOkActive(),(null==(t=document.querySelector(".custom-play"))?void 0:t.classList.contains("d-none"))||this.isSquareModeActive&&this.drawAllSquares())}constructor(t="svgCanvas"){(0,s._)(this,"svg",void 0),(0,s._)(this,"dotRadius",8),(0,s._)(this,"spacing",74.5),(0,s._)(this,"leftOffset",14.7),(0,s._)(this,"topOffset",12.7),(0,s._)(this,"dots",[]),(0,s._)(this,"selectedDots",[]),(0,s._)(this,"drawnLines",[]),(0,s._)(this,"dotsGroup",null),(0,s._)(this,"isDrawing",!1),(0,s._)(this,"startDot",null),(0,s._)(this,"previewLine",null),(0,s._)(this,"previewCircle",null),(0,s._)(this,"currentColor","black"),(0,s._)(this,"polygonColorMap",new Map),(0,s._)(this,"polygonsManager",void 0),(0,s._)(this,"squareRects",[]),(0,s._)(this,"squareLines",[]),(0,s._)(this,"bindClick",void 0),(0,s._)(this,"modeList",void 0),(0,s._)(this,"line",void 0),(0,s._)(this,"paint",void 0),(0,s._)(this,"square",void 0),(0,s._)(this,"colors",void 0),this.svg=document.getElementById(t),this.initDots(),this.polygonsManager=new f(this.svg,this.drawnLines,this.polygonColorMap,this.currentColor),this.bindClick=this.hnClick.bind(this),this.setPaintbucket(),this.setMakeMode(),setTimeout(()=>{let t=this.modeList.map(t=>document.querySelector(`.${t}-mode`)).find(t=>t&&t.classList.contains("active"));if(t){let e=this.getCurrentStrokeColor();t.style.background=e,t.style.color="#fff"}this.checkBtnOkActive()},0);let e=document.querySelector(".reset-all");e&&e.addEventListener("click",()=>{n.play("button"),this.clearAllLines()})}}class v extends m{init(t){super.init(t),this.bindClick=this.hnClick.bind(this),this.bindKeyDown=this.onKeyDown.bind(this),this.bindKeyUp=this.onKeyUp.bind(this),this.btnOk=this.root.querySelector(".btn-ok"),this.btnOk.btnType="btn-ok",this.btnOk.addEventListener("click",this.bindClick),this.root.addEventListener("keydown",this.bindKeyDown,!0),this.root.addEventListener("keyup",this.bindKeyUp,!0),this.btnList=[],this.makeBoard=[],this.kIconPlayList=[],this.shapePlayList=[],this.numberPlayList=[],this.setBtn(),this.setMakeBoard()}setBtn(){this.setMainBtns(),this.setPlayBtns(),this.setButtonList()}setMakeBoard(){this.root.querySelectorAll(".make-board-list .make-board").forEach(t=>this.makeBoard.push(t))}clear(){super.clear(),this.root.removeEventListener("keydown",this.bindKeyDown,!0),this.root.removeEventListener("keyup",this.bindKeyUp,!0),this.hideRoot()}start(){super.start(),this.showRoot(),this.btnOk.classList.add("dim");let t=this.root.querySelector(".btn-list .btn.active");t?"custom"===t.btnType?this.checkSVG():this.checkItems():(this.makeBoard[0].classList.remove("d-none"),this.shapeBtn.classList.add("active"),this.checkItems())}showRoot(){this.root.classList.remove("d-none")}hideRoot(){this.root.classList.add("d-none")}checkSVG(){let t=this.root.querySelector("#svgCanvas");if(!t)return void this.btnOk.classList.add("dim");let e=t.querySelectorAll("line, rect, polygon"),i=!1;e.forEach(t=>{let e=t.getAttribute("fill")||window.getComputedStyle(t).fill;e&&"transparent"!==e&&"none"!==e&&"rgba(0, 0, 0, 0)"!==e&&(i=!0)}),requestAnimationFrame(()=>{i?this.btnOk.classList.remove("dim"):this.btnOk.classList.add("dim")})}checkItems(){let t=this.makeBoard.find(t=>!t.classList.contains("d-none"));if(!t)return void this.btnOk.classList.add("dim");let e=t.querySelector(".item.active");requestAnimationFrame(()=>{e?this.btnOk.classList.remove("dim"):this.btnOk.classList.add("dim")})}hnClick(t){let e=t.target,i=t.target.btnType;if(this.isDisabledByClass(e)){t.preventDefault(),t.stopPropagation();return}switch(n.play("button"),i){case"btn-ok":this.handleOkButtonClick();break;case"shape":case"k-icon":case"number":case"custom":this.handleTabButtonClick(e,i);break;case"k-icon-item":case"shape-item":case"number-item":this.handleItemButtonClick(e,i),this.checkItems()}}onKeyDown(t){let e=t.key;if(" "!==e&&"Spacebar"!==e&&"Enter"!==e)return;let i=t.target??document.activeElement;this.isDisabledByClass(i)&&(t.preventDefault(),t.stopPropagation())}onKeyUp(t){let e=t.key;if(" "!==e&&"Spacebar"!==e&&"Enter"!==e)return;let i=t.target??document.activeElement;this.isDisabledByClass(i)&&(t.preventDefault(),t.stopPropagation())}isDisabledByClass(t){if(!t)return!1;let e=t;for(;e&&e!==this.root;){if(e.classList&&(e.classList.contains("dim")||e.classList.contains("pe-none")))return!0;e=e.parentElement}return!1}setMainBtns(){this.shapeBtn=this.root.querySelector(".shape-btn"),this.shapeBtn.btnType="shape",this.shapeBtn.addEventListener("click",this.bindClick),this.kIconBtn=this.root.querySelector(".k-icon-btn"),this.kIconBtn.btnType="k-icon",this.kIconBtn.addEventListener("click",this.bindClick),this.numberBtn=this.root.querySelector(".number-btn"),this.numberBtn.btnType="number",this.numberBtn.addEventListener("click",this.bindClick),this.customBtn=this.root.querySelector(".custom-btn"),this.customBtn.btnType="custom",this.customBtn.addEventListener("click",this.bindClick)}setPlayBtns(){this.setKIconPlayBtns(),this.setShapePlayBtns(),this.setNumberPlayBtns()}setKIconPlayBtns(){this.kIconPlay=this.root.querySelector(".k-icon-play"),this.kIconPlay.querySelectorAll(".k-icon-item").forEach((t,e)=>{t.idx=e,t.btnType="k-icon-item",t.addEventListener("click",this.bindClick),this.kIconPlayList.push(t)})}setShapePlayBtns(){this.root.querySelector(".shape-play").querySelectorAll(".shape-item").forEach((t,e)=>{t.idx=e,t.btnType="shape-item",t.addEventListener("click",this.bindClick),this.shapePlayList.push(t)})}setNumberPlayBtns(){this.root.querySelector(".number-play").querySelectorAll(".number-item").forEach((t,e)=>{t.idx=e,t.btnType="number-item",t.addEventListener("click",this.bindClick),this.numberPlayList.push(t)})}setButtonList(){this.root.querySelectorAll(".btn-list .btn").forEach(t=>this.btnList.push(t))}handleOkButtonClick(){let t=this.root.querySelector(".custom-play");t&&!t.classList.contains("d-none")?this.handleCustomPlayMode():this.handleNormalMode()}handleCustomPlayMode(){this.createSVGInShapeBox(),this.svgManager&&this.svgManager.exportImageAndSize().then(t=>{t&&t.success&&this.addClassesToTargetSvg()}),a(window,{message:L.GO_GAME,self:this});let t=document.querySelector(".originalShape");t&&t.remove()}handleNormalMode(){a(window,{message:L.GO_GAME,self:this,itemUrl:this.itemUrl,beforeBgW:this.beforeBgW,beforeBgH:this.beforeBgH})}createSVGInShapeBox(){let t=document.querySelector(".shape-box");if(!t)return;let e=t.querySelector("svg");e&&e.remove();let i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("viewBox","0 0 150 150"),i.style.position="absolute",i.style.top="0",i.style.left="1px",i.style.width="150px",i.style.height="150px",i.style.pointerEvents="none",this.createDotGrid(i),t.appendChild(i)}createDotGrid(t){for(let e=0;e<6;e++)for(let i=0;i<6;i++){let s=1+30*i,o=0+30*e,n=document.createElementNS("http://www.w3.org/2000/svg","circle");n.setAttribute("cx",s.toString()),n.setAttribute("cy",o.toString()),n.setAttribute("r","4"),n.setAttribute("fill","#666"),t.appendChild(n)}}addClassesToTargetSvg(){let t=document.querySelector(".shape-box"),e=null==t?void 0:t.querySelector("svg");e&&e.classList.add("shape","originalShape","custom")}handleTabButtonClick(t,e){switch(this.btnList.forEach(t=>t.classList.remove("active")),this.makeBoard.forEach(t=>t.classList.add("d-none")),t.classList.add("active"),this.btnOk.classList.add("dim"),e){case"shape":this.makeBoard[0].classList.remove("d-none"),this.checkItems();break;case"k-icon":this.makeBoard[1].classList.remove("d-none"),this.checkItems();break;case"number":this.makeBoard[2].classList.remove("d-none"),this.checkItems();break;case"custom":this.makeBoard[3].classList.remove("d-none"),this.initCustomMode(),this.checkSVG()}}initCustomMode(){this.svgManager||(this.svgManager=new b("svgCanvas"))}handleItemButtonClick(t,e){this.getPlayListByType(e)&&(this.root.querySelectorAll(".board .item.active").forEach(t=>{t.classList.remove("active")}),t.classList.add("active"),this.extractItemUrl(t),requestAnimationFrame(()=>{this.btnOk.classList.remove("dim")}))}getPlayListByType(t){switch(t){case"k-icon-item":return this.kIconPlayList;case"shape-item":return this.shapePlayList;case"number-item":return this.numberPlayList;default:return null}}extractItemUrl(t){let e=window.getComputedStyle(t,"::before").backgroundImage,i=window.getComputedStyle(t,"::before").width,s=window.getComputedStyle(t,"::before").height,o=e.match(/url\(["']?([^"')]+)["']?\)/);if(o){let t=o[1];t=t.replace(/^http:\/\/localhost:3001/,".."),this.itemUrl=t,this.beforeBgW=i,this.beforeBgH=s}}constructor(t){super(t),(0,s._)(this,"btnOk",void 0),(0,s._)(this,"bindClick",void 0),(0,s._)(this,"bindKeyDown",void 0),(0,s._)(this,"bindKeyUp",void 0),(0,s._)(this,"btnList",void 0),(0,s._)(this,"makeBoard",void 0),(0,s._)(this,"kIconPlayList",void 0),(0,s._)(this,"shapePlayList",void 0),(0,s._)(this,"numberPlayList",void 0),(0,s._)(this,"shapeBtn",void 0),(0,s._)(this,"kIconBtn",void 0),(0,s._)(this,"numberBtn",void 0),(0,s._)(this,"customBtn",void 0),(0,s._)(this,"kIconPlay",void 0),(0,s._)(this,"svgManager",null),(0,s._)(this,"itemUrl",void 0),(0,s._)(this,"beforeBgW",void 0),(0,s._)(this,"beforeBgH",void 0)}}var _=i(415);class S{executeAllActions(){if(0!==this.aniList.length){if(this.isPlaying){this.playBtn.classList.add("pe-none"),this.stopAtCurrentStep();return}if(this.openPopBtn.classList.contains("active"))return void this.closePopupAnimation();this.root.querySelector(".open-pop-btn").classList.add("dim"),this.isPlaying=!0,this.createClonedShapes(),this.executeGsapTimeline()}}stopAtCurrentStep(){var t;this.isPlaying=!1,this.currentAnimationIndex=-1,this.shouldStopAfterCurrent=!1,null==(t=this.currentTimeline)||t.kill(),this.openPopupAnimation(),this.playBtn.classList.remove("active"),this.playBtn.textContent="",this.playBtn.classList.remove("pe-none"),this.enableControls()}createClonedShapes(){let t=this.root.querySelector(".shape-box"),e=this.root.querySelector(".originalShape");t&&e&&(this.cleanupExistingShapes(),this.accumulatedRotate=0,this.createCurrentClonedShape(t,e),this.createFirstClonedShape(t,e))}cleanupExistingShapes(){if(this.currentTimeline&&(this.currentTimeline.kill(),this.currentTimeline=null),this.currentClonedShape)y.ZP.killTweensOf(this.currentClonedShape),this.currentClonedShape.remove(),this.currentClonedShape=null;else{let t=this.root.querySelector(".copyShape");t&&(y.ZP.killTweensOf(t),t.remove())}if(this.firstClonedShape)y.ZP.killTweensOf(this.firstClonedShape),this.firstClonedShape.remove(),this.firstClonedShape=null;else{let t=this.root.querySelector(".firstCopyShape");t&&(y.ZP.killTweensOf(t),t.remove())}}createCurrentClonedShape(t,e){this.revertBackgroundImageUrl(e),this.currentClonedShape=e.cloneNode(!0),this.currentClonedShape.classList.remove("originalShape"),this.currentClonedShape.classList.add("copyShape"),e.classList.contains("custom")&&"svg"===e.tagName.toLowerCase()?this.setSvgStyles(this.currentClonedShape,e):this.setShapeStyles(this.currentClonedShape,e),this.currentClonedShape.style.zIndex="10",this.currentClonedShape.style.opacity="1",t.appendChild(this.currentClonedShape),this.syncGsapTransform(this.currentClonedShape,e)}createFirstClonedShape(t,e){this.firstClonedShape=e.cloneNode(!0),this.firstClonedShape.classList.remove("originalShape"),this.firstClonedShape.classList.add("firstCopyShape","pe-none"),e.classList.contains("custom")&&"svg"===e.tagName.toLowerCase()?this.setSvgStyles(this.firstClonedShape,e):this.setShapeStyles(this.firstClonedShape,e),this.firstClonedShape.style.opacity="0",t.appendChild(this.firstClonedShape),this.syncGsapTransform(this.firstClonedShape,e)}syncGsapTransform(t,e){y.ZP.set(t,{x:y.ZP.getProperty(e,"x"),y:y.ZP.getProperty(e,"y"),scale:y.ZP.getProperty(e,"scale"),rotationY:y.ZP.getProperty(e,"rotationY"),rotationX:y.ZP.getProperty(e,"rotationX"),rotate:y.ZP.getProperty(e,"rotate"),force3D:!0})}setShapeStyles(t,e){t.style.position="absolute",t.style.width=e.style.width,t.style.height=e.style.height,t.style.transformOrigin=e.style.transformOrigin,t.style.left=e.style.left,t.style.top=e.style.top,t.style.transform=e.style.transform,t.style.backgroundImage=e.style.backgroundImage,t.style.willChange="transform, opacity"}setSvgStyles(t,e){t.style.position="absolute",t.style.width=e.style.width,t.style.height=e.style.height,t.style.transformOrigin=e.style.transformOrigin,t.style.left=e.style.left,t.style.top=e.style.top,t.style.transform=e.style.transform,e.getAttribute("viewBox")&&t.setAttribute("viewBox",e.getAttribute("viewBox")),e.getAttribute("width")&&t.setAttribute("width",e.getAttribute("width")),e.getAttribute("height")&&t.setAttribute("height",e.getAttribute("height")),t.style.willChange="transform, opacity"}executeGsapTimeline(){this.scrollToAction();let t=this.createGsapTimeline();this.currentTimeline=t,this.aniList.forEach((e,i)=>{if(!e.playState)return;let s=this.createGsapProps(e,i);this.addGsapToTimeline(t,s,i)})}createGsapProps(t,e){let i={duration:1,delay:.3,ease:"power2.out",force3D:!0},s=this.root.querySelector(".originalShape"),o=s&&s.classList.contains("custom")&&"svg"===s.tagName.toLowerCase(),n=0,r=0;switch(o&&(n=0,r=0),t.type){case"push":i.x=`+=${(t.moveX||0)+n}`,i.y=`+=${(t.moveY||0)+r}`;break;case"flip":let a=this.accumulatedRotate;for(let t=0;t<e;t++){let e=this.aniList[t];e&&"swing"===e.type&&e.playState&&(a+=e.swingValue||0)}let l=(a%360+360)%360,h=1>Math.abs(l-90)||1>Math.abs(l-270)||1>Math.abs(l+90)||1>Math.abs(l+270),c=t.flipMoveX??0,d=t.flipMoveY??0,p=t.flipDirection;if(p||(0!==(t.flipRotateX_relative||0)?p=t.flipRotateX_relative>0?"up":"down":0!==(t.flipRotateY_relative||0)&&(p=t.flipRotateY_relative>0?"right":"left")),p){let t=this.currentClonedShape||this.firstClonedShape,e=t&&(parseFloat(t.style.width)||t.offsetWidth)||0,i=t&&(parseFloat(t.style.height)||t.offsetHeight)||0;switch(p){case"up":c=0,d=-i;break;case"down":c=0,d=i;break;case"left":c=-e,d=0;break;case"right":c=e,d=0}}h?(i.rotationY=`+=${t.flipRotateX_relative}`,i.rotationX=`+=${t.flipRotateY_relative}`):(i.rotationX=`+=${t.flipRotateX_relative}`,i.rotationY=`+=${t.flipRotateY_relative}`),i.x=`+=${c+n}`,i.y=`+=${d+r}`;break;case"swing":i.rotate=`+=${t.swingValue}`}return i}addGsapToTimeline(t,e,i){let s=this.root.querySelector(".action-list");t.to(this.firstClonedShape,{...e,duration:0,force3D:!0,onComplete:()=>{this.checkBoundsCheck()&&(this.showWarnPop(),t.kill())}}),e.onStart=()=>{this.currentAnimationIndex=i;let t=null==s?void 0:s.querySelector(`.action[data-idx="${i}"]`);t&&(this.scrollToAction(t),t.classList.add("act-select"))},e.onComplete=()=>{let t=this.aniList[i];t&&"swing"===t.type&&t.playState&&(this.accumulatedRotate+=t.swingValue||0);let e=null==s?void 0:s.querySelector(`.action[data-idx="${i}"]`);!this.checkBoundsCheck()&&e&&e.classList.remove("act-select")},t.to(this.currentClonedShape,e)}createGsapTimeline(){return y.ZP.timeline({onStart:()=>{this.originalShape=this.root.querySelector(".originalShape"),this.originalShape.classList.add("ani-play"),this.originalShape&&this.convertBackgroundImageUrl(this.originalShape)},onComplete:()=>{this.resetGsapState(),this.originalShape=this.root.querySelector(".originalShape"),this.originalShape.classList.remove("ani-play")}})}convertBackgroundImageUrl(t){let e=t.style.backgroundImage;if(e){let i=e.match(/url\(["']?([^"')]+)["']?\)/);if(i){let e=i[1];if(e.includes("intro_board/shape_icon/")){let i=e.replace("intro_board/shape_icon/","game_board/shape_origin/shape_icon/");t.style.backgroundImage=`url("${i}")`}else if(e.includes("intro_board/k_icon/")){let i=e.replace("intro_board/k_icon/","game_board/shape_origin/k_icon/");t.style.backgroundImage=`url("${i}")`}else if(e.includes("intro_board/num_icon/")){let i=e.replace("intro_board/num_icon/","game_board/shape_origin/num_icon/");t.style.backgroundImage=`url("${i}")`}}}"svg"===t.tagName.toLowerCase()&&this.convertSVGColor(t)}revertBackgroundImageUrl(t){let e=t.style.backgroundImage;if(e){let i=e.match(/url\(["']?([^"')]+)["']?\)/);if(i){let e=i[1];if(e.includes("game_board/shape_origin/shape_icon/")){let i=e.replace("game_board/shape_origin/shape_icon/","intro_board/shape_icon/");t.style.backgroundImage=`url("${i}")`}else if(e.includes("game_board/shape_origin/k_icon/")){let i=e.replace("game_board/shape_origin/k_icon/","intro_board/k_icon/");t.style.backgroundImage=`url("${i}")`}else if(e.includes("game_board/shape_origin/num_icon/")){let i=e.replace("game_board/shape_origin/num_icon/","intro_board/num_icon/");t.style.backgroundImage=`url("${i}")`}}}"svg"===t.tagName.toLowerCase()&&this.revertSVGColor(t)}convertSVGColor(t){"svg"===t.tagName.toLowerCase()&&([...Array.from(t.querySelectorAll("rect")),...Array.from(t.querySelectorAll("polygon"))].forEach(t=>{let e=t.getAttribute("fill")||t.style.fill;e&&"none"!==e&&"transparent"!==e&&(t.setAttribute("data-original-fill",e),t.hasAttribute("fill")?t.setAttribute("fill","#899397"):t.style.fill="#899397")}),t.querySelectorAll("line").forEach(t=>{let e=t.getAttribute("stroke")||t.style.stroke;e&&"none"!==e&&"transparent"!==e&&(t.setAttribute("data-original-stroke",e),t.hasAttribute("stroke")?t.setAttribute("stroke","#52585a"):t.style.stroke="#52585a")}))}revertSVGColor(t){"svg"===t.tagName.toLowerCase()&&([...Array.from(t.querySelectorAll("rect")),...Array.from(t.querySelectorAll("polygon"))].forEach(t=>{let e=t.getAttribute("data-original-fill");e&&(t.hasAttribute("fill")?t.setAttribute("fill",e):t.style.fill=e,t.removeAttribute("data-original-fill"))}),t.querySelectorAll("line").forEach(t=>{let e=t.getAttribute("data-original-stroke");e&&(t.hasAttribute("stroke")?t.setAttribute("stroke",e):t.style.stroke=e,t.removeAttribute("data-original-stroke"))}))}resetGsapState(){this.isPlaying=!1,this.currentTimeline=null,this.currentAnimationIndex=-1,this.shouldStopAfterCurrent=!1,this.accumulatedRotate=0,setTimeout(()=>{this.playBtn.classList.remove("active"),this.playBtn.textContent="",this.openPopupAnimation()},600)}disableControls(){this.openPopBtn.classList.add("pe-none"),this.onOffBtn.classList.add("pe-none"),this.root.querySelector(".option-pop-right .scroll-cont").classList.add("pe-none");let t=this.root.querySelector(".option-pop-left");t&&t.classList.add("pe-none")}enableControls(){this.onOffBtn.classList.remove("pe-none"),this.openPopBtn.classList.remove("pe-none"),this.root.querySelector(".option-pop-right .scroll-cont").classList.remove("pe-none");let t=this.root.querySelector(".option-pop-left");t&&t.classList.remove("pe-none")}checkBoundsCheck(){let t,e=this.root.querySelector(".shape-container");if(!e)return!1;let i=e.getBoundingClientRect();if(this.firstClonedShape.classList.contains("custom")&&"svg"===this.firstClonedShape.tagName.toLowerCase()){let e=this.firstClonedShape.querySelector("g");t=e?e.getBoundingClientRect():this.firstClonedShape.getBoundingClientRect()}else t=this.firstClonedShape.getBoundingClientRect();let s=t.left<i.left,o=t.right>i.right,n=t.top<i.top,r=t.bottom>i.bottom,a=s||o||n||r;if(a){let t=this.root.querySelector(".action-list"),e=this.currentAnimationIndex+1,i=null;for(;e<this.aniList.length;){let s=null==t?void 0:t.querySelector(`.action[data-idx="${e}"]`);if(s&&!s.classList.contains("dim")){i=s;break}e++}i&&i.classList.add("act-select")}return a}getOffsetInContainer(t,e,i){let s={x:0,y:0};i&&(s.x+=t.offsetWidth/2,s.y+=t.offsetHeight/2);let o=t;for(;o&&o!==e;)s.x+=o.offsetLeft,s.y+=o.offsetTop,o=o.offsetParent;return s}showWarnPop(){this.isPlaying=!1,this.currentTimeline=null,this.root.querySelector(".warn-pop").classList.remove("d-none"),setTimeout(()=>{let t=this.root.querySelector(".js-scroll-cont"),e=this.root.querySelector(".act-select");if(!t||!("scrollObj"in t))return;let i=t.scrollObj.elements().viewport,s=Math.max(0,e.offsetTop-i.clientHeight/2);i.scrollTo({top:s,behavior:"smooth"})},0)}scrollToAction(t){let e=this.root.querySelector(".js-scroll-cont");if(!e||!("scrollObj"in e))return;let i=e.scrollObj,s=i.elements().viewport;if(t){let o=this.getOffsetInContainer(t,e),n=o.y+t.offsetHeight-s.offsetHeight;n=Math.max(0,n=Math.min(n,i.state().overflowAmount.y));let r=s.scrollTop,a=o.y+t.offsetHeight-r,l=o.y-r;(a>s.offsetHeight||l<0)&&s.scrollTo({top:n+195,behavior:"smooth"})}else s.scrollTo({top:0,behavior:"smooth"})}updateAccumulatedRotate(t){this.accumulatedRotate=t}getIsPlaying(){return this.isPlaying}setIsPlaying(t){this.isPlaying=t}getCurrentTimeline(){return this.currentTimeline}closePopupAnimation(){let t=this.root.querySelector(".shape-container"),e=this.root.querySelector(".option-pop-left"),i=this.root.querySelector(".open-pop-btn");this.resetBtn.classList.add("pe-none"),this.playBtn.classList.add("pe-none");let s=y.ZP.timeline();s.to(i,{left:976,duration:.6,ease:"power2.out",force3D:!0,onStart:()=>{i.classList.remove("active"),i.classList.add("dim")}}),s.to(e,{left:1e3,duration:.6,ease:"power2.out",force3D:!0,onComplete:()=>{e.classList.remove("on"),this.openPopBtn.classList.remove("active"),this.isPlaying=!0,this.createClonedShapes(),this.executeGsapTimeline(),this.resetBtn.classList.remove("pe-none"),this.playBtn.classList.remove("pe-none")}},"<"),s.to(t,{left:339,duration:.6,ease:"power2.out",force3D:!0},"<"),s.to(e.querySelectorAll(".title-box"),{opacity:0,duration:.3,ease:"power2.out",force3D:!0},"<+=0.05"),this.disableControls()}openPopupAnimation(){let t=this.root.querySelector(".shape-container"),e=this.root.querySelector(".option-pop-left"),i=this.root.querySelector(".open-pop-btn"),s=y.ZP.timeline();s.to(i,{onStart:()=>{i.classList.add("active"),i.classList.remove("dim")},left:660,duration:.6,ease:"power2.out",force3D:!0}),s.to(e,{left:685,duration:.6,ease:"power2.out",force3D:!0,onStart:()=>{e.classList.add("on")}},"<"),s.to(t,{left:39,duration:.6,ease:"power2.out",force3D:!0},"<"),s.to(e.querySelectorAll(".title-box"),{opacity:1,delay:.05,duration:.3,ease:"power2.out",force3D:!0},"<+=0.05"),this.playBtn.classList.remove("pe-none"),this.resetBtn.classList.remove("pe-none"),this.enableControls()}closePopup(t){let e=this.root.querySelector(".option-pop-left"),i=this.root.querySelector(".shape-container"),s=y.ZP.timeline();s.to(t,{left:976,duration:.6,ease:"power2.out",force3D:!0}),s.to(e,{left:1e3,duration:.6,ease:"power2.out",force3D:!0,onComplete:()=>{e.classList.remove("on")}},"<"),s.to(i,{left:339,duration:.6,ease:"power2.out",force3D:!0},"<"),s.to(e.querySelectorAll(".title-box"),{opacity:0,duration:.3,ease:"power2.out",force3D:!0},"<+=0.05"),t.classList.remove("active")}openPopup(t){let e=this.root.querySelector(".option-pop-left"),i=this.root.querySelector(".shape-container"),s=y.ZP.timeline();s.to(t,{left:660,duration:.6,ease:"power2.out",force3D:!0}),s.to(e,{left:685,duration:.6,ease:"power2.out",force3D:!0,onStart:()=>{e.classList.add("on")}},"<"),s.to(i,{left:39,duration:.6,ease:"power2.out",force3D:!0},"<"),s.to(e.querySelectorAll(".title-box"),{opacity:1,delay:.05,duration:.3,ease:"power2.out",force3D:!0},"<+=0.05"),t.classList.add("active")}constructor(t,e,i){(0,s._)(this,"root",void 0),(0,s._)(this,"aniList",void 0),(0,s._)(this,"originalShape",null),(0,s._)(this,"currentClonedShape",null),(0,s._)(this,"firstClonedShape",null),(0,s._)(this,"isPlaying",!1),(0,s._)(this,"currentTimeline",null),(0,s._)(this,"accumulatedRotate",0),(0,s._)(this,"currentAnimationIndex",-1),(0,s._)(this,"shouldStopAfterCurrent",!1),(0,s._)(this,"resetBtn",void 0),(0,s._)(this,"onOffBtn",void 0),(0,s._)(this,"openPopBtn",void 0),(0,s._)(this,"playBtn",void 0),this.root=t,this.aniList=e,this.resetBtn=i.resetBtn,this.onOffBtn=i.onOffBtn,this.openPopBtn=i.openPopBtn,this.playBtn=i.playBtn}}class A{initAllButtons(){this.setBtn(),this.setArrowBox(),this.setCentimeterBox(),this.setPopupLeft(),this.setFlipBox(),this.setSwingBox(),this.setAddBtn(),this.setPlayBtn(),this.setResetBtn(),this.setonOffBtn(),this.setshapeHomeBtn(),this.setWarnPopBtn(),this.setHomeReset()}setBtn(){this.setupButtonGroup(".option-pop-left .option-box .option","option-box",this.game.optionBtnList),this.game.selectedActionModes={push:!0,flip:!1,swing:!1,playState:!0}}setArrowBox(){this.setupButtonGroup(".option-pop-left .option-control .arrow-box .arrow","arrow",this.game.arrowBtnList)}setCentimeterBox(){this.setupButtonGroup(".option-pop-left .option-control .centimeter-box .cm","cm",this.game.cmBtnList)}setPopupLeft(){this.game.openPopBtn=this.game.rootElement.querySelector(".open-pop-btn"),this.game.openPopBtn.btnType="popup",this.game.openPopBtn.addEventListener("click",this.game.bindClick)}setFlipBox(){let t=["left","right","up","down"];this.game.rootElement.querySelectorAll(".option-pop-left .option-control .flip-box .flip").forEach((e,i)=>{e.btnType="flip",e.idx=i,e.setAttribute("data-direction",t[i]||"right"),e.addEventListener("click",this.game.bindClick),this.game.flipBtnList.push(e)})}setSwingBox(){let t=this.game.rootElement.querySelectorAll(".option-pop-left .option-control .swing-box.type-r .swing-r");[90,180,270,360].forEach((e,i)=>{let s=t[i];s&&(s.btnType="swing",s.idx=i,s.setAttribute("data-angle",e.toString()),s.addEventListener("click",this.game.bindClick),this.game.swingBtnList.push(s))});let e=this.game.rootElement.querySelectorAll(".option-pop-left .option-control .swing-box.type-l .swing-l");[90,180,270,360].forEach((t,i)=>{let s=e[i];s&&(s.btnType="swing",s.idx=i,s.setAttribute("data-angle",t.toString()),s.addEventListener("click",this.game.bindClick),this.game.swingBtnList.push(s))})}setAddBtn(){this.game.addBtn=this.game.rootElement.querySelector(".option-pop-left .add-btn"),this.game.addBtn.btnType="add-btn",this.game.addBtn.addEventListener("click",this.game.bindClick)}setPlayBtn(){this.game.playBtn=this.game.rootElement.querySelector(".option-pop-right .play"),this.game.playBtn.btnType="play",this.game.playBtn.addEventListener("click",this.game.bindClick)}setResetBtn(){this.game.resetBtn=this.game.rootElement.querySelector(".option-pop-right .reset"),this.game.resetBtn.btnType="reset",this.game.resetBtn.addEventListener("click",this.game.bindClick)}setonOffBtn(){this.game.onOffBtn=this.game.rootElement.querySelector(".option-pop-right .on-off-btn"),this.game.onOffBtn.btnType="all-on-off",this.game.onOffBtn.addEventListener("click",this.game.bindClick)}setshapeHomeBtn(){this.game.shapeHomeBtn=this.game.rootElement.querySelector(".shape-home"),this.game.shapeHomeBtn.btnType="shape-home",this.game.shapeHomeBtn.addEventListener("click",this.game.bindClick)}setWarnPopBtn(){this.game.warnPopBtn=this.game.rootElement.querySelector(".warn-pop .colse-btn"),this.game.warnPopBtn.btnType="warn-pop",this.game.warnPopBtn.addEventListener("click",this.game.bindClick),this.game.warnCountPopBtn=this.game.rootElement.querySelector(".warn-pop-count .colse-btn"),this.game.warnCountPopBtn.btnType="warn-count-pop",this.game.warnCountPopBtn.addEventListener("click",this.game.bindClick)}setHomeReset(){this.game.home=document.querySelector(".home"),this.game.home.btnType="home",this.game.home.addEventListener("click",this.game.bindClick)}setupButtonGroup(t,e,i){this.game.rootElement.querySelectorAll(t).forEach((t,s)=>{t.btnType=e,t.idx=s,t.addEventListener("click",this.game.bindClick),i.push(t)})}constructor(t){(0,s._)(this,"game",void 0),this.game=t}}y.ZP.config({nullTargetWarn:!1,autoSleep:60,force3D:!0});class w extends m{get rootElement(){return this.root}get getLastSelectedOptionIndex(){return this.lastSelectedOptionIndex}start(){if(super.start(),this.showRoot(),this.gsapExecutor&&this.gsapExecutor.updateAccumulatedRotate(0),this.props.itemUrl){let t=this.root.querySelector(".originalShape"),e=this.root.querySelector(".shape-box");if(!t&&e&&((t=document.createElement("div")).classList.add("shape","originalShape"),t.removeAttribute("style"),e.appendChild(t)),t&&e){if("svg"!==t.tagName.toLowerCase()&&(t.style.backgroundImage=`url("${this.props.itemUrl}")`),this.props.beforeBgW){let e=parseFloat(this.props.beforeBgW||"0");t.style.width=e?`${Math.ceil(.78*e)}px`:""}if(this.props.beforeBgH){let e=parseFloat(this.props.beforeBgH||"0");t.style.height=e?`${Math.ceil(.78*e)}px`:""}t.style.position="absolute",t.style.transformOrigin="center center",y.ZP.set(t,{x:0,y:0,scale:1}),this.checkAndAddCustomClass(this.props.itemUrl)}}this.home.classList.remove("dim")}checkAndAddCustomClass(t){if(t&&t.includes("num_icon_05.png")){let t=this.root.querySelector(".originalShape");t&&(t.classList.add("custom-01"),y.ZP.set(t,{x:15,y:0,transformOrigin:"60px 90px",scale:1}))}if(t&&t.includes("k_icon_08.png")){let t=this.root.querySelector(".originalShape");t&&(t.classList.add("custom-02"),y.ZP.set(t,{x:0,y:-15,transformOrigin:"60px 90px",scale:1}))}}init(t){super.init(t),this.bindClick=this.hnClick.bind(this),this.bindKeyDown=this.onKeyDown.bind(this),this.bindKeyUp=this.onKeyUp.bind(this),this.btnManager.initAllButtons(),this.createScroll(),this.initGsapExecutor(),this.root.addEventListener("keydown",this.bindKeyDown,!0),this.root.addEventListener("keyup",this.bindKeyUp,!0)}onKeyDown(t){let e=t.key;if(" "!==e&&"Spacebar"!==e&&"Enter"!==e)return;let i=t.target??document.activeElement;this.isDisabledByClass(i)&&(t.preventDefault(),t.stopPropagation())}onKeyUp(t){let e=t.key;if(" "!==e&&"Spacebar"!==e&&"Enter"!==e)return;let i=t.target??document.activeElement;this.isDisabledByClass(i)&&(t.preventDefault(),t.stopPropagation())}initGsapExecutor(){this.gsapExecutor=new S(this.root,this.aniList,{resetBtn:this.resetBtn,onOffBtn:this.onOffBtn,openPopBtn:this.openPopBtn,playBtn:this.playBtn})}createScroll(){this.root.querySelectorAll(".js-scroll-cont").forEach(t=>{let e=(0,_.UN)(t,{scrollbars:{theme:"os-theme-custom "},overflow:{x:"hidden",y:"scroll"}});t.scrollObj=e,e.update()})}hnClick(t){let e=t.target,i=t.target,s=i.btnType,o=i.idx;if(t.stopPropagation(),t.stopImmediatePropagation(),this.isDisabledByClass(e))return void t.preventDefault();switch(n.play("button"),s){case"option-box":this.handleOptionBoxClick(e,o);break;case"arrow":this.handleArrowClick(e,o);break;case"cm":this.handleCmClick(e,o);break;case"flip":this.handleFlipClick(e);break;case"swing":this.handleSwingClick(e);break;case"popup":this.handlePopupClick(e);break;case"add-btn":this.addCurrentActionToList();break;case"play":this.handlePlayClick(e),this.removeActive();break;case"all-on-off":this.handleAllOnOffClick(e);break;case"reset":this.resetMethod();break;case"warn-pop":this.hidWarnPop();break;case"warn-count-pop":this.hidWarnCountPop();break;case"home":case"home-reset":break;case"shape-home":this.homeMethod()}}isDisabledByClass(t){if(!t)return!1;let e=t;for(;e&&e!==this.root;){if(e.classList&&(e.classList.contains("dim")||e.classList.contains("pe-none")))return!0;e=e.parentElement}return!1}handleOptionBoxClick(t,e){this.clearAllActive();let i=this.root.querySelectorAll(".option-pop-left .option-control .control");i.forEach(t=>t.classList.add("d-none")),this.clearActiveClasses(this.optionBtnList),t.classList.add("active"),i[e].classList.remove("d-none"),this.lastSelectedOptionIndex=e;let s=this.root.querySelector(".option-control");s&&(s.classList.remove("option-push","option-flip","option-swing"),t.classList.contains("option-push")?s.classList.add("option-push"):t.classList.contains("option-flip")?s.classList.add("option-flip"):t.classList.contains("option-swing")&&s.classList.add("option-swing")),this.selectedActionModes={push:0===e,flip:1===e,swing:2===e,playState:!0},this.addBtn&&this.addBtn.classList.add("dim")}clearAllActive(){this.clearActiveClasses(this.arrowBtnList),this.clearActiveClasses(this.cmBtnList),this.clearActiveClasses(this.flipBtnList),this.clearActiveClasses(this.swingBtnList),this.addBtn&&this.addBtn.classList.add("dim")}clearActiveClasses(t){t.forEach(t=>t.classList.remove("active"))}handleArrowClick(t,e){this.clearActiveClasses(this.arrowBtnList),t.classList.add("active"),this.resetMoveState(),this.setDirectionByIndex(e);let i=this.cmBtnList.find(t=>t.classList.contains("active"));i&&(this.moveUnitValue=(i.idx+1)*30),this.checkAddBtnActive()}resetMoveState(){this.moveRight=!1,this.moveLeft=!1,this.moveUp=!1,this.moveDown=!1,this.moveUnitValue=0,this.swingRotateValue=0}setDirectionByIndex(t){0===t?this.moveUp=!0:1===t?this.moveRight=!0:2===t?this.moveDown=!0:3===t&&(this.moveLeft=!0)}checkAddBtnActive(){if(this.addBtn){if(this.addBtn.classList.add("dim"),this.root.querySelector(".option-push.active")){let t=this.root.querySelector(".option-control .control-push");if(t){let e=t.querySelectorAll(".arrow.active").length,i=t.querySelectorAll(".cm.active").length;1===e&&1===i&&this.addBtn.classList.remove("dim")}}else if(this.root.querySelector(".option-flip.active")){let t=this.root.querySelector(".option-control .control-flip");t&&1===t.querySelectorAll(".flip.active").length&&this.addBtn.classList.remove("dim")}else if(this.root.querySelector(".option-swing.active")){let t=this.root.querySelector(".option-control .control-swing");t&&1===t.querySelectorAll(".swing.active").length&&this.addBtn.classList.remove("dim")}}}handleCmClick(t,e){this.clearActiveClasses(this.cmBtnList),t.classList.add("active"),this.moveUnitValue=(e+1)*30,this.checkAddBtnActive()}handleFlipClick(t){this.clearActiveClasses(this.flipBtnList),t.classList.add("active"),this.checkAddBtnActive()}handleSwingClick(t){this.clearActiveClasses(this.swingBtnList),t.classList.add("active"),this.swingRotateValue=this.calculateSwingAngle(t),this.checkAddBtnActive()}calculateSwingAngle(t){let e=t.getAttribute("data-angle"),i=e?parseInt(e,10):90;return t.classList.contains("swing-l")?-Math.abs(i):Math.abs(i)}handlePopupClick(t){var e,i;t.classList.contains("active")?null==(e=this.gsapExecutor)||e.closePopup(t):null==(i=this.gsapExecutor)||i.openPopup(t)}addCurrentActionToList(){this.root.querySelectorAll(".option-pop-left .option-box .option").forEach((t,e)=>{t.classList.contains("active")&&(this.selectedActionModes={push:0===e,flip:1===e,swing:2===e,playState:!0})});let t={};if(this.selectedActionModes.push){let e=0,i=0;this.moveRight?e=this.moveUnitValue:this.moveLeft&&(e=-this.moveUnitValue),this.moveUp?i=-this.moveUnitValue:this.moveDown&&(i=this.moveUnitValue),t.type="push",t.moveX=e,t.moveY=i,t.playState=!0}if(this.selectedActionModes.flip){let e=this.flipBtnList.find(t=>t.classList.contains("active")),i=null==e?void 0:e.getAttribute("data-direction"),s=0,o=0;switch(i){case"up":s=180;break;case"down":s=-180;break;case"left":o=-180;break;case"right":o=180}t.type="flip",t.flipRotateX_relative=s,t.flipRotateY_relative=o,t.flipMoveX=0,t.flipMoveY=0,t.flipDirection=i||void 0,t.playState=!0}this.selectedActionModes.swing&&(t.type="swing",t.swingValue=this.swingRotateValue,t.playState=!0),t.type&&(this.aniList.push(t),this.renderActionItem(t,this.aniList.length-1),Object.keys(this.selectedActionModes).forEach(t=>{this.selectedActionModes[t]=!1}),this.updatePlayBtnDim(),this.updateActionNumbers()),1===this.aniList.length&&this.onOffBtn.classList.remove("pe-none"),10===this.aniList.length&&this.showWarnCountPop()}updateActionIndices(){let t=this.root.querySelector(".action-list"),e=(null==t?void 0:t.querySelectorAll(".action"))||[];if(e.forEach((t,e)=>{t.setAttribute("data-idx",e.toString());let i=t.querySelector(".number");i&&(i.textContent=`${e+1}`);let s=t.querySelector(".arr-up.btn");s&&(s.setAttribute("data-idx",e.toString()),s.replaceWith(s.cloneNode(!0)),t.querySelector(".arr-up.btn").addEventListener("click",()=>this.moveActionItemUp(e)));let o=t.querySelector(".arr-down.btn");o&&(o.setAttribute("data-idx",e.toString()),o.replaceWith(o.cloneNode(!0)),t.querySelector(".arr-down.btn").addEventListener("click",()=>this.moveActionItemDown(e)));let n=t.querySelector(".del.btn");n&&(n.setAttribute("data-idx",e.toString()),n.replaceWith(n.cloneNode(!0)),t.querySelector(".del.btn").addEventListener("click",()=>this.deleteActionItem(e)));let r=t.querySelector(".on-off.btn");r&&(r.setAttribute("data-idx",e.toString()),r.replaceWith(r.cloneNode(!0)),t.querySelector(".on-off.btn").addEventListener("click",t=>this.toggleActionOnOff(e,t.currentTarget)))}),e.forEach(t=>{let e=t.querySelector(".arr-up.btn");e&&e.classList.remove("dim");let i=t.querySelector(".arr-down.btn");i&&i.classList.remove("dim")}),e[0]){let t=e[0].querySelector(".arr-up.btn");t&&t.classList.add("dim")}if(e.length>0){let t=e[e.length-1].querySelector(".arr-down.btn");t&&t.classList.add("dim")}}moveActionItemUp(t){if(0===t)return;n.play("button"),this.swap(this.aniList,t,t-1);let e=this.root.querySelector(".action-list"),i=Array.from((null==e?void 0:e.children)||[]);i[t]&&i[t-1]&&(null==e||e.insertBefore(i[t],i[t-1])),this.updateActionIndices(),this.updateActionNumbers()}moveActionItemDown(t){if(t===this.aniList.length-1)return;n.play("button"),this.swap(this.aniList,t,t+1);let e=this.root.querySelector(".action-list"),i=Array.from((null==e?void 0:e.children)||[]);i[t]&&i[t+1]&&(null==e||e.insertBefore(i[t+1],i[t])),this.updateActionIndices(),this.updateActionNumbers()}deleteActionItem(t){n.play("button"),this.aniList.splice(t,1);let e=this.root.querySelector(".action-list"),i=null==e?void 0:e.querySelector(`.action[data-idx="${t}"]`);i&&i.remove(),null==e||e.querySelectorAll(".action").forEach((t,e)=>{t.setAttribute("data-idx",e.toString());let i=t.querySelector(".del.btn");if(i){i.setAttribute("data-idx",e.toString());let t=i.cloneNode(!0);i.replaceWith(t),t.addEventListener("click",()=>this.deleteActionItem(e))}}),this.updateActionIndices(),this.updatePlayBtnDim(),this.updateActionNumbers(),0===this.aniList.length&&(this.onOffBtn.classList.add("pe-none"),this.onOffBtn.classList.remove("active"))}toggleActionOnOff(t,e){n.play("button");let i=this.aniList[t];if(!i)return;i.playState=!i.playState,e.classList.toggle("active",!i.playState);let s=e.closest(".action");e.classList.contains("active")?s.classList.add("dim"):s.classList.remove("dim");let o=Array.from(this.root.querySelectorAll(".action-list .action"));o.length>0&&o.every(t=>t.classList.contains("dim"))?this.playBtn.classList.add("dim"):this.playBtn.classList.remove("dim"),this.updateActionNumbers()}updatePlayBtnDim(){let t=this.root.querySelector(".action-list"),e=this.playBtn;if(!t||!e)return;let i=t.querySelectorAll(".action").length;i>0?e.classList.remove("dim"):e.classList.add("dim"),i>0?this.resetBtn.classList.remove("dim"):this.resetBtn.classList.add("dim")}updateActionNumbers(){let t=Array.from(this.root.querySelectorAll(".action-list .action")),e=1;t.forEach(t=>{let i=t.querySelector(".number");if(!i)return;let s=t.querySelector(".on-off.btn");s&&!s.classList.contains("active")?(i.textContent=e.toString(),e++):i.textContent=""})}removeActive(){this.root.querySelectorAll(".option-control .control .active").forEach(t=>t.classList.remove("active")),this.addBtn.classList.add("dim")}hidWarnPop(){var t;this.root.querySelector(".warn-pop").classList.add("d-none"),this.openPopBtn.classList.remove("pe-none"),this.root.querySelector(".option-pop-left").classList.remove("pe-none"),this.root.querySelector(".option-pop-right  .scroll-cont").classList.remove("pe-none"),this.playBtn.textContent="",this.playBtn.classList.remove("dim"),this.playBtn.classList.remove("active"),this.onOffBtn.classList.remove("pe-none"),this.root.querySelectorAll(".shape-box .firstCopyShape").forEach(t=>{t.remove()}),null==(t=this.gsapExecutor)||t.openPopupAnimation()}showWarnCountPop(){var t;this.aniList.pop(),null==(t=this.root.querySelector(".warn-pop-count"))||t.classList.remove("d-none")}hidWarnCountPop(){var t;null==(t=this.root.querySelector(".warn-pop-count"))||t.classList.add("d-none")}handlePlayClick(t){t.classList.add("active"),t.textContent="",this.gsapExecutor&&(this.root.querySelectorAll(".action.act-select").forEach(t=>t.classList.remove("act-select")),this.gsapExecutor.executeAllActions()),setTimeout(()=>{let t=this.root.querySelector(".js-scroll-cont");t&&"scrollObj"in t&&t.scrollObj.elements().viewport.scrollTo({top:0,behavior:"smooth"})},0)}handleAllOnOffClick(t){let e=t.classList.toggle("active"),i=this.root.querySelector(".action-list");if(i.querySelectorAll(".action .sub-change-box").forEach(t=>t.classList.toggle("invisible",!e)),t.classList.contains("active")){let t=i.querySelectorAll(".action");t.length>0&&Array.from(t).every(t=>t.classList.contains("dim")),this.playBtn.classList.add("dim")}else{let t=i.querySelectorAll(".action");t.length>0&&Array.from(t).every(t=>t.classList.contains("dim")),this.playBtn.classList.remove("dim")}}resetMethod(){if(this.gsapExecutor){if(this.gsapExecutor.getIsPlaying()){this.gsapExecutor.setIsPlaying(!1);let t=this.gsapExecutor.getCurrentTimeline();t&&t.kill()}this.gsapExecutor.enableControls()}let t=this.root.querySelector(".action-list");if(t&&(t.innerHTML=""),this.root.querySelectorAll(".shape-box .copyShape, .shape-box .firstCopyShape").forEach(t=>t.remove()),this.resetMoveState(),this.gsapExecutor){this.gsapExecutor.updateAccumulatedRotate(0),this.gsapExecutor.openPopupAnimation();let t=this.root.querySelector(".originalShape");this.gsapExecutor.revertBackgroundImageUrl(t)}this.selectedActionModes={push:!1,flip:!1,swing:!1,playState:!0},this.clearAllActive(),this.addBtn&&this.addBtn.classList.add("dim"),this.playBtn.classList.remove("active"),this.playBtn.textContent="",this.updatePlayBtnDim(),this.root.querySelectorAll(".shape-box .shape").forEach(t=>{t.classList.contains("copyShale")&&t.remove(),t.classList.contains("firstCopyShape")&&t.remove()}),this.aniList.length=0,this.updateActionNumbers(),this.openPopBtn.classList.remove("dim"),this.handleAllOnOffClick(this.onOffBtn),this.playBtn.classList.add("dim"),this.onOffBtn.classList.remove("active"),this.onOffBtn.classList.add("pe-none")}renderActionItem(t,e){let i=this.root.querySelector(".action-list");if(!i||10===this.aniList.length)return;let s=this.createActionElement(t,e),{subActBox:o,subChangeBox:n}=this.createActionButtons(t,e),r=this.createModeElements(t),a=this.createActionNumber(e);s.appendChild(o),s.appendChild(n),s.appendChild(r),s.appendChild(a),s.style.position="relative",this.positionSubChangeBox(n,r),i.appendChild(s),this.updateActionIndices(),setTimeout(()=>{let t=this.root.querySelector(".js-scroll-cont");if(!t||!("scrollObj"in t))return;let e=t.scrollObj,i=e.elements().viewport,s=e.state().overflowAmount.y;s>0&&i.scrollTo({top:s,behavior:"smooth"})},0)}createActionElement(t,e){let i=document.createElement("div");return i.classList.add("action"),i.setAttribute("data-idx",e.toString()),"push"===t.type?i.classList.add("mode-push"):"flip"===t.type?i.classList.add("mode-flip"):"swing"===t.type&&i.classList.add("mode-swing"),i}createActionNumber(t){let e=document.createElement("div");return e.classList.add("number"),e.textContent=`${t+1}`,e}createActionButtons(t,e){let i=document.createElement("div");i.classList.add("sub-act-box");let s=this.createOnOffButton(t,e),o=this.createDeleteButton(e),{up:n,down:r}=this.createArrowButtons(e),a=document.createElement("div");return this.onOffBtn.classList.contains("active")?a.classList.add("sub-change-box"):a.classList.add("sub-change-box","invisible"),a.appendChild(n),a.appendChild(r),i.appendChild(s),i.appendChild(o),{subActBox:i,subChangeBox:a}}createOnOffButton(t,e){let i=document.createElement("button");return i.classList.add("on-off","btn"),i.setAttribute("data-idx",e.toString()),t.playState||i.classList.add("active"),i.addEventListener("click",t=>{this.toggleActionOnOff(e,t.currentTarget)}),i}createDeleteButton(t){let e=document.createElement("button");return e.classList.add("del","btn"),e.setAttribute("data-idx",t.toString()),e.addEventListener("click",e=>{this.deleteActionItem(t)}),e}createArrowButtons(t){let e=document.createElement("button");e.classList.add("arr-up","btn"),e.setAttribute("data-idx",t.toString()),e.addEventListener("click",()=>this.moveActionItemUp(t));let i=document.createElement("button");return i.classList.add("arr-down","btn"),i.setAttribute("data-idx",t.toString()),i.addEventListener("click",()=>this.moveActionItemDown(t)),{up:e,down:i}}createModeElements(t){let e=document.createElement("div");e.classList.add("mode","item");let i=document.createElement("div");i.classList.add("move","item");let s=document.createElement("div");s.classList.add("length","item");let o=document.createElement("div");return o.classList.add("sub-mode-box"),o.appendChild(e),o.appendChild(i),"push"===t.type&&o.appendChild(s),this.setModeTexts(t,e,i,s),o}setModeTexts(t,e,i,s){if("push"===t.type){e.textContent="",t.moveX>0?i.textContent="":t.moveX<0?i.textContent="":t.moveY<0?i.textContent="":t.moveY>0&&(i.textContent="");let o=Math.abs(t.moveX||t.moveY)/30;s.textContent=`${o}cm`}else if("flip"===t.type)e.textContent="",0!==t.flipRotateX_relative?i.textContent=t.flipRotateX_relative>0?"":"":0!==t.flipRotateY_relative&&(i.textContent=t.flipRotateY_relative>0?"":"");else if("swing"===t.type){e.textContent="";let s=t.swingValue>0?" ":"  ";i.textContent=`${s} ${Math.abs(t.swingValue)}\xb0`}}positionSubChangeBox(t,e){requestAnimationFrame(()=>{let i=e.offsetTop+e.offsetHeight/2-t.offsetHeight/2,s=e.offsetLeft+e.offsetWidth;y.ZP.set(t,{position:"absolute",top:i-2,left:s+10})})}homeMethod(){if(a(window,{message:L.GO_INTRO,self:this}),this.gsapExecutor&&this.gsapExecutor.updateAccumulatedRotate(0),this.root.querySelectorAll(".shape-box .shape").forEach(t=>{t.removeAttribute("style"),t&&"svg"===t.tagName.toLowerCase()&&t.remove()}),this.gsapExecutor){if(this.gsapExecutor.getIsPlaying()){this.gsapExecutor.setIsPlaying(!1);let t=this.gsapExecutor.getCurrentTimeline();t&&t.kill()}this.gsapExecutor.enableControls(),this.root.querySelectorAll(".action.act-select").forEach(t=>t.classList.remove("act-select")),this.playBtn.textContent="",this.playBtn.classList.remove("active"),this.gsapExecutor.openPopupAnimation()}this.aniList.length>0?this.onOffBtn.classList.remove("pe-none"):this.onOffBtn.classList.add("pe-none"),this.openPopBtn.classList.remove("dim")}swap(t,e,i){let s=t[e];t[e]=t[i],t[i]=s}clear(){super.clear(),y.ZP.killTweensOf(this.root),this.root.removeEventListener("keydown",this.bindKeyDown,!0),this.root.removeEventListener("keyup",this.bindKeyUp,!0),this.hideRoot()}showRoot(){this.root.classList.remove("d-none")}hideRoot(){this.root.classList.add("d-none")}constructor(t){super(t),(0,s._)(this,"homeReset",void 0),(0,s._)(this,"home",void 0),(0,s._)(this,"btnOk",void 0),(0,s._)(this,"optionPush",void 0),(0,s._)(this,"optionFlip",void 0),(0,s._)(this,"optionswing",void 0),(0,s._)(this,"optionBtnList",[]),(0,s._)(this,"arrowBtnList",[]),(0,s._)(this,"cmBtnList",[]),(0,s._)(this,"flipBtnList",[]),(0,s._)(this,"swingBtnList",[]),(0,s._)(this,"warnPopBtn",void 0),(0,s._)(this,"warnCountPopBtn",void 0),(0,s._)(this,"openPopBtn",void 0),(0,s._)(this,"addBtn",void 0),(0,s._)(this,"playBtn",void 0),(0,s._)(this,"resetBtn",void 0),(0,s._)(this,"onOffBtn",void 0),(0,s._)(this,"shapeHomeBtn",void 0),(0,s._)(this,"moveRight",!1),(0,s._)(this,"moveLeft",!1),(0,s._)(this,"moveUp",!1),(0,s._)(this,"moveDown",!1),(0,s._)(this,"moveUnitValue",0),(0,s._)(this,"swingRotateValue",0),(0,s._)(this,"selectedActionModes",{push:!1,flip:!1,swing:!1,playState:!0}),(0,s._)(this,"lastSelectedOptionIndex",0),(0,s._)(this,"aniList",[]),(0,s._)(this,"bindClick",void 0),(0,s._)(this,"bindKeyDown",void 0),(0,s._)(this,"bindKeyUp",void 0),(0,s._)(this,"gsapExecutor",null),(0,s._)(this,"btnManager",void 0),this.btnManager=new A(this)}}class C{preloadImages(){this.imageList.forEach(t=>{let e=this.loadImage(t);this.loadPromises.push(e)})}loadImage(t){return new Promise((e,i)=>{let s=new Image;s.onload=()=>{this.loadedImages.set(t,s),e()},s.onerror=()=>{i(Error(`\u{C774}\u{BBF8}\u{C9C0} \u{B85C}\u{B4DC} \u{C2E4}\u{D328}: ${t}`))},s.src=t})}async waitForAllImages(){try{await Promise.all(this.loadPromises),l("  .")}catch(t){}}constructor(){(0,s._)(this,"imageList",["./images/game_board/board.png","./images/game_board/board_cm.png","./images/game_board/board_control/arrow.png","./images/game_board/board_control/control_arrow_0001.png","./images/game_board/board_control/control_arrow_0002.png","./images/game_board/board_control/control_flip0001.png","./images/game_board/board_control/control_flip0002.png","./images/game_board/board_control/control_swing_l_01_0001.png","./images/game_board/board_control/control_swing_l_01_0002.png","./images/game_board/board_control/control_swing_l_02_0001.png","./images/game_board/board_control/control_swing_l_02_0002.png","./images/game_board/board_control/control_swing_l_03_0001.png","./images/game_board/board_control/control_swing_l_03_0002.png","./images/game_board/board_control/control_swing_l_04_0001.png","./images/game_board/board_control/control_swing_l_04_0002.png","./images/game_board/board_control/control_swing_r_01_0001.png","./images/game_board/board_control/control_swing_r_01_0002.png","./images/game_board/board_control/control_swing_r_02_0001.png","./images/game_board/board_control/control_swing_r_02_0002.png","./images/game_board/board_control/control_swing_r_03_0001.png","./images/game_board/board_control/control_swing_r_03_0002.png","./images/game_board/board_control/control_swing_r_04_0001.png","./images/game_board/board_control/control_swing_r_04_0002.png","./images/game_icon/dim_0001.png","./images/game_icon/dim_0002.png","./images/game_icon/dim_0003.png","./images/game_icon/onoff_0001.png","./images/game_icon/onoff_0002.png","./images/game_icon/play.png","./images/game_icon/play_dim.png","./images/game_icon/reset.png","./images/game_icon/reset_dim.png","./images/game_icon/stop.png","./images/game_icon/on-off_0001.png","./images/game_icon/on-off_0002.png","./images/game_icon/plus_0001.png","./images/game_icon/plus_0002.png","./images/intro_board/board.png","./images/intro_board/board_on.png","./images/intro_board/check_icon.png","./images/intro_board/check_icon_dim.png","./images/intro_board/k_icon/k_icon_01.png","./images/intro_board/k_icon/k_icon_02.png","./images/intro_board/k_icon/k_icon_03.png","./images/intro_board/k_icon/k_icon_04.png","./images/intro_board/k_icon/k_icon_05.png","./images/intro_board/k_icon/k_icon_06.png","./images/intro_board/k_icon/k_icon_07.png","./images/intro_board/k_icon/k_icon_08.png","./images/intro_board/k_icon/k_icon_09.png","./images/intro_board/k_icon/k_icon_10.png","./images/intro_board/num_icon/num_icon_01.png","./images/intro_board/num_icon/num_icon_02.png","./images/intro_board/num_icon/num_icon_03.png","./images/intro_board/num_icon/num_icon_04.png","./images/intro_board/num_icon/num_icon_05.png","./images/intro_board/num_icon/num_icon_06.png","./images/intro_board/num_icon/num_icon_07.png","./images/intro_board/num_icon/num_icon_08.png","./images/intro_board/num_icon/num_icon_09.png","./images/intro_board/num_icon/num_icon_10.png","./images/intro_board/shape_icon/shape_icon_01.png","./images/intro_board/shape_icon/shape_icon_02.png","./images/intro_board/shape_icon/shape_icon_03.png","./images/intro_board/shape_icon/shape_icon_04.png","./images/intro_board/shape_icon/shape_icon_05.png","./images/intro_board/shape_icon/shape_icon_06.png","./images/intro_board/shape_icon/shape_icon_07.png","./images/intro_board/shape_icon/shape_icon_08.png","./images/intro_board/shape_icon/shape_icon_09.png","./images/intro_board/shape_icon/shape_icon_10.png","./images/intro_board/custom_play/board.png","./images/intro_board/custom_play/check_icon.png","./images/intro_board/custom_play/cm.png","./images/intro_board/custom_play/line_icon.png","./images/intro_board/custom_play/line_icon_active.png","./images/intro_board/custom_play/paint_icon_active.png","./images/intro_board/custom_play/paint_icon.png","./images/intro_board/custom_play/rect_icon.png","./images/intro_board/custom_play/rect_icon_active.png","./images/intro_title_icon/icon_cus.png","./images/intro_title_icon/icon_cus_on.png","./images/intro_title_icon/icon_k.png","./images/intro_title_icon/icon_k_on.png","./images/intro_title_icon/icon_num.png","./images/intro_title_icon/icon_num_on.png","./images/intro_title_icon/icon_shape.png","./images/intro_title_icon/icon_shape_on.png","./images/intro_title_icon/home_0001.png","./images/intro_title_icon/home_0002.png","./images/intro_title_icon/header.png","./images/intro_title_icon/arrow.png","./images/game_board/shape_origin/k_icon/k_icon_01.png","./images/game_board/shape_origin/k_icon/k_icon_02.png","./images/game_board/shape_origin/k_icon/k_icon_03.png","./images/game_board/shape_origin/k_icon/k_icon_04.png","./images/game_board/shape_origin/k_icon/k_icon_05.png","./images/game_board/shape_origin/k_icon/k_icon_06.png","./images/game_board/shape_origin/k_icon/k_icon_07.png","./images/game_board/shape_origin/k_icon/k_icon_08.png","./images/game_board/shape_origin/k_icon/k_icon_09.png","./images/game_board/shape_origin/k_icon/k_icon_10.png","./images/game_board/shape_origin/num_icon/num_icon_01.png","./images/game_board/shape_origin/num_icon/num_icon_02.png","./images/game_board/shape_origin/num_icon/num_icon_03.png","./images/game_board/shape_origin/num_icon/num_icon_04.png","./images/game_board/shape_origin/num_icon/num_icon_05.png","./images/game_board/shape_origin/num_icon/num_icon_06.png","./images/game_board/shape_origin/num_icon/num_icon_07.png","./images/game_board/shape_origin/num_icon/num_icon_08.png","./images/game_board/shape_origin/num_icon/num_icon_09.png","./images/game_board/shape_origin/num_icon/num_icon_10.png","./images/game_board/shape_origin/shape_icon/shape_icon_01.png","./images/game_board/shape_origin/shape_icon/shape_icon_02.png","./images/game_board/shape_origin/shape_icon/shape_icon_03.png","./images/game_board/shape_origin/shape_icon/shape_icon_04.png","./images/game_board/shape_origin/shape_icon/shape_icon_05.png","./images/game_board/shape_origin/shape_icon/shape_icon_06.png","./images/game_board/shape_origin/shape_icon/shape_icon_07.png","./images/game_board/shape_origin/shape_icon/shape_icon_08.png","./images/game_board/shape_origin/shape_icon/shape_icon_09.png","./images/game_board/shape_origin/shape_icon/shape_icon_10.png"]),(0,s._)(this,"loadedImages",new Map),(0,s._)(this,"loadPromises",[]),this.preloadImages()}}class L extends g{init(){super.init(),this.imagePreloader.waitForAllImages().then(()=>{this.start()}).catch(()=>{this.start()}),this.introCont=this.root.querySelector(".intro-cont"),this.gameCont=this.root.querySelector(".game-cont"),(this.sampleProps.sounds.list||[]).forEach((t,e)=>{n.add(t)})}initCC(){super.initCC()}hnMessage(t){super.hnMessage(t);let e=t.detail;switch(e.message){case L.GO_INTRO:this.setStep(0);break;case L.GO_GAME:let i=new w({root:".game-cont",itemUrl:e.itemUrl,beforeBgW:e.beforeBgW,beforeBgH:e.beforeBgH});this.steps[1]=i,this.cc?i.init(this.cc):i.init(),this.setStep(1)}}addSteps(t){this.steps=t}start(){this.addSteps([new v({root:".intro-cont"}),new w({root:".game-cont"})]),this.steps.forEach(t=>{this.cc?t.init(this.cc):t.init()}),this.sampleProps.startStepIndex?this.setStep(this.sampleProps.startStepIndex):this.setStep(0)}setStep(t){t<0||t>this.steps.length-1||(n.stopAll(),this.stepIndex=t,this.step&&this.step.clear(),this.step=this.steps[t],this.step.start())}constructor(t){super(t),(0,s._)(this,"sampleProps",void 0),(0,s._)(this,"imagePreloader",void 0),(0,s._)(this,"introCont",void 0),(0,s._)(this,"gameCont",void 0),(0,s._)(this,"step",void 0),(0,s._)(this,"steps",void 0),(0,s._)(this,"stepIndex",void 0),this.sampleProps=t,this.imagePreloader=new C}}(0,s._)(L,"GO_INTRO","GO_INTRO"),(0,s._)(L,"GO_GAME","GO_GAME"),i(919);let k=new class{setupInit(t){this.initPage=t}noDelay(){this.isNoDelay=!0}init(){this.initButtonHover(),this.initScale(),n.add([{id:"button",src:c,ignoreStop:!0}]),this.isNoDelay?this.showContent():this.tioShow=setTimeout(()=>{this.showContent()},1e3)}initButtonHover(){var t;(Array.isArray(t=Array.from(new Set([...Array.from(document.querySelectorAll('*[class*="btn"]:not([class*="btns"])')),...Array.from(document.querySelectorAll("button"))])))?t:[t]).forEach(t=>{t.addEventListener("pointerenter",e=>{"touch"!==(e.pointerType||"touch")&&t.classList.add("hover")}),t.addEventListener("pointerleave",e=>{"touch"!==(e.pointerType||"touch")&&t.classList.remove("hover")})})}showContent(){if(this.root&&this.root.classList.remove("hidden"),this.tioShow&&clearTimeout(this.tioShow),1===this.pages.length){let t=this.pages[0];t.init(),t.activate()}else for(let t of this.pages)t.init();a(window,{message:"CONTENT_READY"})}hnMessage(t){let e=t.detail;l("hnMessage :: ",e.message),e.message}initScale(){this.resize&&(this.setScale(),window.addEventListener("resize",()=>{this.setScale()}),window.addEventListener("orientationchange",()=>{setTimeout(()=>{this.setScale()},1e3)}))}setScale(){this.root&&(window.bound=function(t,e,i){let s=Math.min(window.innerWidth/1280,window.innerHeight/720),o=(window.innerWidth-1280*s)/2,n=(window.innerHeight-720*s)/2;return t.style.transformOrigin="top left",t.style.left=`${o}px`,t.style.top=`${n}px`,t.style.transform=`scale(${s})`,{x:o,y:n,scale:s}}(this.root,1280,720),a(window,{message:"CONTENT_RESIZE"}))}constructor(t){for(let e of((0,s._)(this,"props",void 0),(0,s._)(this,"resize",void 0),(0,s._)(this,"root",void 0),(0,s._)(this,"pages",[]),(0,s._)(this,"initPage",void 0),(0,s._)(this,"tioShow",void 0),(0,s._)(this,"isNoDelay",!1),(0,s._)(this,"messageHandler",void 0),this.props=t??{},this.resize=this.props.resize??!0,window.oncontextmenu=t=>(t.preventDefault(),t.stopPropagation(),!1),this.root=document.querySelector("#wrap"),Array.from(document.querySelectorAll("img"))))e.draggable=!1;window.addEventListener("load",()=>{this.pages=this.initPage(),this.init()}),this.messageHandler=this.hnMessage.bind(this),window.addEventListener("MESSAGE",this.messageHandler)}};k.noDelay(),k.setupInit(function(){return[new L({root:".root",sounds:{list:[]}})]})}},e={};function i(s){var o=e[s];if(void 0!==o)return o.exports;var n=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=t,i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),i.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(t){if("object"==typeof window)return window}})(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=[];i.O=(e,s,o,n)=>{if(s){n=n||0;for(var r=t.length;r>0&&t[r-1][2]>n;r--)t[r]=t[r-1];t[r]=[s,o,n];return}for(var a=1/0,r=0;r<t.length;r++){for(var[s,o,n]=t[r],l=!0,h=0;h<s.length;h++)(!1&n||a>=n)&&Object.keys(i.O).every(t=>i.O[t](s[h]))?s.splice(h--,1):(l=!1,n<a&&(a=n));if(l){t.splice(r--,1);var c=o();void 0!==c&&(e=c)}}return e}})(),i.rv=()=>"1.3.8",(()=>{i.g.importScripts&&(t=i.g.location+"");var t,e=i.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var s=e.getElementsByTagName("script");if(s.length)for(var o=s.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=s[o--].src}if(!t)throw Error("Automatic publicPath is not supported in this browser");i.p=(t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"))+"../"})(),(()=>{var t={980:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var o,n,[r,a,l]=s,h=0;if(r.some(e=>0!==t[e])){for(o in a)i.o(a,o)&&(i.m[o]=a[o]);if(l)var c=l(i)}for(e&&e(s);h<r.length;h++)n=r[h],i.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return i.O(c)},s=self.webpackChunkamanta_2025_project=self.webpackChunkamanta_2025_project||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})(),i.ruid="bundler=rspack@1.3.8";var s=i.O(void 0,["971"],function(){return i(591)});s=i.O(s)})();